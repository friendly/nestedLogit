<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Provides functions for specifying and fitting nested
    dichotomy logistic regression models for a multi-category response and
    methods for summarising and plotting those models.  Nested dichotomies are
    statistically independent, and hence provide an additive decomposition
    of tests for the overall polytomous response.  When the dichotomies
    make sense substantively, this method can be a simpler alternative to
    the standard multinomial logistic model which compares response
    categories to a reference level.  See: J. Fox (2016), "Applied
    Regression Analysis and Generalized Linear Models", 3rd Ed., ISBN
    1452205663.'>
<title>Nested Dichotomy Logistic Regression Models • nestedLogit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Nested Dichotomy Logistic Regression Models">
<meta property="og:description" content='Provides functions for specifying and fitting nested
    dichotomy logistic regression models for a multi-category response and
    methods for summarising and plotting those models.  Nested dichotomies are
    statistically independent, and hence provide an additive decomposition
    of tests for the overall polytomous response.  When the dichotomies
    make sense substantively, this method can be a simpler alternative to
    the standard multinomial logistic model which compares response
    categories to a reference level.  See: J. Fox (2016), "Applied
    Regression Analysis and Generalized Linear Models", 3rd Ed., ISBN
    1452205663.'>
<meta property="og:image" content="http://friendly.github.io/nestedLogit/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">nestedLogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/nestedLogit.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/plotting-ggplot.html">Plotting nestedLogit models with ggplot2</a>
    <a class="dropdown-item" href="articles/standard-errors.html">Standard Errors of Fitted Category Probabilities by the Delta Method for the Nested Logit Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/nestedLogit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<!-- badges: end -->
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="nestedlogit-">nestedLogit <a class="anchor" aria-label="anchor" href="#nestedlogit-"></a>
</h1>
</div>
<p><strong>Version 0.3.2</strong></p>
<p>The <code>nestedLogit</code> package provides functions for fitting nested dichotomy logistic regression models for a polytomous response. Nested dichotomies are statistically independent, and hence provide an additive decomposition of tests for the overall polytomous response. When the dichotomies make sense substantively, this method can be a simpler alternative to the standard multinomial logistic model which compares response categories to a reference level.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<table class="table">
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<tbody>
<tr class="odd">
<td>CRAN version</td>
<td><code>install.packages("nestedLogit")</code></td>
</tr>
<tr class="even">
<td>Development version</td>
<td><code>remotes::install_github("friendly/nestedLogit")</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="package-overview">Package overview<a class="anchor" aria-label="anchor" href="#package-overview"></a>
</h2>
<p>The package provides one main function, <code><a href="reference/nestedLogit.html">nestedLogit()</a></code> for fitting the set of <span class="math inline">(<em>m</em>−1)</span> binary logistic regression models for a polytomous response with <span class="math inline"><em>m</em></span> levels. These can be specified using helper functions,</p>
<ul>
<li>
<code><a href="reference/nestedLogit.html">dichotomy()</a></code>: constructs a <em>single</em> dichotomy among the levels of a response factor;</li>
<li>
<code><a href="reference/nestedLogit.html">logits()</a></code>: creates the set of dichotomies, typically using <code><a href="reference/nestedLogit.html">dichotomy()</a></code> for each.</li>
<li>
<code><a href="reference/nestedLogit.html">continuationLogits()</a></code>: provides a convenient way to generate all dichotomies for an ordered response.</li>
</ul>
<p>For instance, a 4-category response, with levels A, B, C, D, and successive binary splits for the dichotomies of interest could be specified as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ABCD</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/nestedLogit.html">logits</a></span><span class="op">(</span>AB.CD <span class="op">=</span> <span class="fu"><a href="reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           A.B <span class="op">=</span> <span class="fu"><a href="reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>           C.D <span class="op">=</span> <span class="fu"><a href="reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; AB.CD: {A, B} vs. {C, D}</span></span>
<span><span class="co">#&gt; A.B: {A} vs. {B}</span></span>
<span><span class="co">#&gt; C.D: {C} vs. {D}</span></span></code></pre></div>
<p>These dichotomies are effectively a tree structure of lists, which can be displayed simply using <code><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">lobstr::tree()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">tree</a></span><span class="op">(</span><span class="va">ABCD</span><span class="op">)</span></span>
<span><span class="co">#&gt; S3&lt;dichotomies&gt;</span></span>
<span><span class="co">#&gt; ├─AB.CD: &lt;list&gt;</span></span>
<span><span class="co">#&gt; │ ├─&lt;chr [2]&gt;"A", "B"</span></span>
<span><span class="co">#&gt; │ └─&lt;chr [2]&gt;"C", "D"</span></span>
<span><span class="co">#&gt; ├─A.B: &lt;list&gt;</span></span>
<span><span class="co">#&gt; │ ├─"A"</span></span>
<span><span class="co">#&gt; │ └─"B"</span></span>
<span><span class="co">#&gt; └─C.D: &lt;list&gt;</span></span>
<span><span class="co">#&gt;   ├─"C"</span></span>
<span><span class="co">#&gt;   └─"D"</span></span></code></pre></div>
<p>Alternatively, the nested dichotomies can be specified more compactly as a nested (i.e., recursive) list with optionally named elements. For example, where people might choose a method of transportation among the categories <code>plane</code>, <code>train</code>, <code>bus</code>, <code>car</code>, a sensible set of three dichotomies could be specified as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transport</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  air <span class="op">=</span> <span class="st">"plane"</span>,</span>
<span>  ground <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"train"</span>, <span class="st">"bus"</span><span class="op">)</span>,</span>
<span>    private <span class="op">=</span> <span class="st">"car"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">tree</a></span><span class="op">(</span><span class="va">transport</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;list&gt;</span></span>
<span><span class="co">#&gt; ├─air: "plane"</span></span>
<span><span class="co">#&gt; └─ground: &lt;list&gt;</span></span>
<span><span class="co">#&gt;   ├─public: &lt;list&gt;</span></span>
<span><span class="co">#&gt;   │ ├─"train"</span></span>
<span><span class="co">#&gt;   │ └─"bus"</span></span>
<span><span class="co">#&gt;   └─private: "car"</span></span></code></pre></div>
<p>There are also methods including <code><a href="reference/nestedMethods.html">as.matrix.dichotomies()</a></code>, <code><a href="reference/nestedMethods.html">as.character.dichotomies()</a></code> to facilitate working with <code>dichotomies</code> objects in other representations. The <code>ABCD</code> example above corresponds to the matrix below, whose rows represent the dichotomies and columns are the response levels:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ABCD</span><span class="op">)</span></span>
<span><span class="co">#&gt;        A  B  C  D</span></span>
<span><span class="co">#&gt; AB.CD  0  0  1  1</span></span>
<span><span class="co">#&gt; A.B    0  1 NA NA</span></span>
<span><span class="co">#&gt; C.D   NA NA  0  1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ABCD</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AB.CD = {{A B}} {{C D}}; A.B = {{A}} {{B}}; C.D = {{C}} {{D}}"</span></span></code></pre></div>
<p>The result of <code><a href="reference/nestedLogit.html">nestedLogit()</a></code> is an object of class <code>"nestedLogit"</code>. It contains the set of <span class="math inline">(<em>m</em>−1)</span> <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> models fit to the dichotomies.</p>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>As befits a model-fitting function, the package defines a nearly complete set of methods for <code>"nestedLogit"</code> objects:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> print the results for each of the submodels.</li>
<li>
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> re-fits the model, allowing changes to the model <code>formula</code>, <code>data</code>, <code>subset</code>, and <code>contrasts</code> arguments.</li>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> returns the coefficients for the predictors in each dichotomy.</li>
<li>
<code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> returns the variance-covariance matrix of the coefficients</li>
<li>
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> computes predicted probabilities for the response categories, either for the cases in the data, which is equivalent to <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>, or for arbitrary combinations of the predictors; the latter is useful for producing plots to aid interpretation.</li>
<li>
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> calculates confidence intervals for the predicted probabilities or predicted logits.</li>
<li>
<code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> method for predicted probabilities and logits converts these to long format for use with <code>ggplot2</code>.</li>
<li>
<code>glance()</code> and <code>tidy()</code> are extensions of <code><a href="https://broom.tidymodels.org/reference/glance.glm.html" class="external-link">broom::glance.glm()</a></code> and <code><a href="https://broom.tidymodels.org/reference/tidy.glm.html" class="external-link">broom::tidy.glm()</a></code> to obtain compact summaries of a <code>"nestedLogit"</code> model object.</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> provides basic plots of the predicted probabilities over a range of values of the predictor variables.</li>
<li>
<code><a href="reference/models.html">models()</a></code> is an extractor function for the binary logit models in the <code>"nestedLogit"</code> object</li>
<li>
<code>Effect()</code> calculates marginal effects collapsed over some variable(s) for the purpose of making effect plots.</li>
</ul>
<p>These functions are supplemented by various methods for testing hypotheses about and comparing nested-logit models:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> provides analysis-of-deviance Type I (sequential) tests for each dichotomy and for the combined model. When given a sequence of model objects, <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> tests the models against one another in the order specified.</li>
<li>
<code>Anova()</code> uses <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> to provide analysis-of-deviance Type II or III (partial) tests for each dichotomy and for the combined model.</li>
<li>
<code>linearHypothesis()</code> uses <code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">car::linearHypothesis()</a></code> to compute Wald tests for hypotheses about coefficients or their linear combinations.</li>
<li>
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> returns the log-likelihood and degrees of freedom for the nested-dichotomies logit model.</li>
<li>Through <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>, the <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code> and <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code> functions compute the Akaike and Bayesian information criteria model-comparison statistics.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>This example uses data on women’s labor force participation to fit a nested logit model for the response, <code>partic</code>, representing categories <code>not.work</code>, <code>parttime</code> and <code>fulltime</code> for 263 women from a 1977 survey in Canada. This dataset is explored in more detail in the package vignette, <code>vignette("nestedLogits", package = "nestedLogit")</code>.</p>
<p>A model for the complete polytomy can be specified as two nested dichotomies, using helper functions <code><a href="reference/nestedLogit.html">dichotomy()</a></code> and <code><a href="reference/nestedLogit.html">logits()</a></code>, as shown in the example that follows:</p>
<ul>
<li>
<code>work</code>: {not.work} vs. {parttime, fulltime}</li>
<li>
<code>full</code>: {parttime} vs. {fulltime}, but only for those working</li>
</ul>
<p><code><a href="reference/nestedLogit.html">nestedLogit()</a></code> effectively fits each of these dichotomies as logistic regression models via <code>glm(..., family = binomial)</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Womenlf</span>, package <span class="op">=</span> <span class="st">"carData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `logits()` and `dichotomy()` to specify the comparisons of interest</span></span>
<span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nestedLogit.html">logits</a></span><span class="op">(</span>work<span class="op">=</span><span class="fu"><a href="reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"not.work"</span>, </span>
<span>                                     working<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      full<span class="op">=</span><span class="fu"><a href="reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nestedLogit.html">nestedLogit</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>,</span>
<span>                 dichotomies <span class="op">=</span> <span class="va">comparisons</span>,</span>
<span>                 data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        work       full</span></span>
<span><span class="co">#&gt; (Intercept)      1.33582979  3.4777735</span></span>
<span><span class="co">#&gt; hincome         -0.04230843 -0.1072679</span></span>
<span><span class="co">#&gt; childrenpresent -1.57564843 -2.6514557</span></span></code></pre></div>
<p>The <code>"nestedLogit"</code> object contains the components of the fitted model. The structure can be shown nicely using <code><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">lobstr::tree()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">|&gt;</span> <span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">tree</a></span><span class="op">(</span>max_depth<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; S3&lt;nestedLogit&gt;</span></span>
<span><span class="co">#&gt; ├─models: &lt;list&gt;...</span></span>
<span><span class="co">#&gt; ├─formula: S3&lt;formula&gt; partic ~ hincome + children...</span></span>
<span><span class="co">#&gt; ├─dichotomies: S3&lt;dichotomies&gt;...</span></span>
<span><span class="co">#&gt; ├─data: S3&lt;data.frame&gt;...</span></span>
<span><span class="co">#&gt; ├─data.name: &lt;symbol&gt; Womenlf</span></span>
<span><span class="co">#&gt; ├─subset: &lt;NULL&gt;</span></span>
<span><span class="co">#&gt; ├─contrasts: &lt;NULL&gt;</span></span>
<span><span class="co">#&gt; └─contrasts.print: "NULL"</span></span></code></pre></div>
<p>The separate models for the <code>work</code> and <code>full</code> dichotomies can be extracted via <code><a href="reference/models.html">models()</a></code>. These are the binomial <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> models.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/models.html">models</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/tree.html" class="external-link">tree</a></span><span class="op">(</span>max_depth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;list&gt;</span></span>
<span><span class="co">#&gt; ├─work: S3&lt;glm/lm&gt;...</span></span>
<span><span class="co">#&gt; └─full: S3&lt;glm/lm&gt;...</span></span></code></pre></div>
<p><code>Anova()</code> produces analysis of variance deviance tests for the terms in this model for each of the submodels, as well as for the combined responses of the polytomy. The <code>LR Chisq</code> and <code>df</code> for terms in the combined model are the sums of those for the submodels.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome    4.8264  1    0.02803 *  </span></span>
<span><span class="co">#&gt; children  31.3229  1  2.185e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome     8.981  1   0.002728 ** </span></span>
<span><span class="co">#&gt; children   32.136  1  1.437e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome    13.808  2   0.001004 ** </span></span>
<span><span class="co">#&gt; children   63.459  2   1.66e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>A basic plot of predicted probabilities can be produced using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code>"nestedLogit"</code> objects. It can be called several times to give multi-panel plots. By default, a 95% pointwise confidence envelope is added to the plot. Here, they are plotted with <code>conf.level = 0.68</code> to give <span class="math inline"> ± 1</span> std. error bounds.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"absent"</span><span class="op">)</span>,</span>
<span>     conf.level <span class="op">=</span> <span class="fl">0.68</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"present"</span><span class="op">)</span>,</span>
<span>     conf.level <span class="op">=</span> <span class="fl">0.68</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-wlf-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ul>
<li><p>A more general discussion of nested dichotomies logistic regression and detailed examples can be found in <code><a href="articles/nestedLogit.html">vignette("nestedLogit")</a></code></p></li>
<li><p>A variety of other plots can be produced using <code>ggplot()</code>, as described in the vignette, <code><a href="articles/plotting-ggplot.html">vignette("plotting-ggplot")</a></code>.</p></li>
<li><p>A new vignette, “<code><a href="articles/standard-errors.html">vignette("standard-errors")</a></code>, describes the mathematics behind the calculation of standard errors using the delta method.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<ul>
<li>John Fox</li>
<li>Michael Friendly</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>S. Fienberg (1980) <em>The Analysis of Cross-Classified Categorical Data</em>, 2nd Edition, MIT Press, Section 6.6.</p>
<p>J. Fox (2016) <em>Applied Regression Analysis and Generalized Linear Models</em>, 3rd Edition, Sage, Section 14.2.2.</p>
<p>M. Friendly and D. Meyers (2016) <em>Discrete Data Analysis with R</em>, CRC Press, Section 8.2.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=nestedLogit" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/friendly/nestedLogit/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/friendly/nestedLogit/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing nestedLogit</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>John Fox <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1196-8012" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Michael Friendly <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3237-0941" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/friendly/nestedLogit" class="external-link"><img src="https://img.shields.io/github/last-commit/friendly/nestedLogit" alt="Last Commit"></a></li>
<li><a href="https://cran.r-project.org/package=nestedLogit" class="external-link"><img src="https://www.r-pkg.org/badges/version/nestedLogit" alt="CRAN status"></a></li>
<li><a href="https://www.r-pkg.org:443/pkg/nestedLogit" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/nestedLogit?color=brightgreen" alt="Downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
