<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nestedLogit">
<title>Nested dichotomies logistic regression models • nestedLogit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested dichotomies logistic regression models">
<meta property="og:description" content="nestedLogit">
<meta property="og:image" content="http://friendly.github.io/nestedLogit/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nestedLogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/nestedLogit-2.html">Nested dichotomies logistic regression models (revised)</a>
    <a class="dropdown-item" href="../articles/nestedLogits.html">Nested dichotomies logistic regression models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/nestedLogit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Nested dichotomies logistic regression models</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly and John Fox</h4>
            
            <h4 data-toc-skip class="date">2023-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/nestedLogit/blob/HEAD/vignettes/nestedLogits.Rmd" class="external-link"><code>vignettes/nestedLogits.Rmd</code></a></small>
      <div class="d-none name"><code>nestedLogits.Rmd</code></div>
    </div>

    
    
<p>Load the packages we’ll use here:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/nestedLogit" class="external-link">nestedLogit</a></span><span class="op">)</span>    <span class="co"># Nested Dichotomy Logistic Regression Models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>          <span class="co"># A General-Purpose Package for Dynamic Report Generation in R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>            <span class="co"># Companion to Applied Regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>          <span class="co"># Convert Statistical Objects into Tidy Tibbles</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>          <span class="co"># A Grammar of Data Manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>        <span class="co"># Create Elegant Data Visualisations Using the Grammar of Graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allancameron.github.io/geomtextpath/" class="external-link">geomtextpath</a></span><span class="op">)</span>   <span class="co"># Curved Text in 'ggplot2'</span></span></code></pre></div>
<div class="section level2">
<h2 id="models-for-polytomous-responses">Models for polytomous responses<a class="anchor" aria-label="anchor" href="#models-for-polytomous-responses"></a>
</h2>
<p>The familiar logistic regression model applies when there is a binary
(“<em>dichotomous</em>”) response, such as “survived” vs. “died”, or
voted “yes” vs. “no” on a referendum. However, often the response
variable is multi-category (“<em>polytomous</em>”), taking on <span class="math inline">\(m &gt; 2\)</span> discrete values. For
example,</p>
<ul>
<li><p>Respondents in the U.S. General Social Survey are classified by
their level of education, taking values <code>&lt;highschool</code>,
<code>highschool</code>, <code>college</code> and
<code>graduate</code>.</p></li>
<li><p>Women’s labor force participation might be classified as (a) not
working outside the home; (b) working parttime; or (c) working
fulltime.</p></li>
</ul>
<p>There are several different ways to model the response probabilities.
Let <span class="math inline">\(\pi_{ij} \equiv \pi_j \, ( \vec{x}_i
)\)</span> be the probability of response <span class="math inline">\(j\)</span> for case or group <span class="math inline">\(i\)</span>, given the predictors <span class="math inline">\(\vec{x}_i\)</span>. Because <span class="math inline">\(\sum_j \, \pi_{ij} = 1\)</span>, only <span class="math inline">\(m - 1\)</span> of these probabilities are
independent. The essential idea is to construct a model for the
polytomous response composed of <span class="math inline">\(m-1\)</span>
logit comparisons among the response categories in a similar way to how
factors are treated in the predictor variables.</p>
<div class="section level3">
<h3 id="multinomial-model">Multinomial model<a class="anchor" aria-label="anchor" href="#multinomial-model"></a>
</h3>
<p>One natural generalization of the the standard logistic regression
<em>logit</em> model is the <em>multinomial logit</em> (or,
<em>generalized logit</em>) model. When the polytomous response has
<span class="math inline">\(m\)</span> levels, the multinomial logit
model is comprised of <span class="math inline">\(m-1\)</span> log odds
comparisons with a reference level, typically the last, as described in
<span class="citation">Fox (2016)</span>, 14.2.1 and <span class="citation">Friendly &amp; Meyer (2016)</span>, 8.3. The standard
implementation of this model is <code><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">multinom()</a></code> in the
<code>nnet</code> package <span class="citation">(Ripley, 2022)</span>.
<!-- TODO: reference R packages --></p>
</div>
<div class="section level3">
<h3 id="nested-logit-model">Nested logit model<a class="anchor" aria-label="anchor" href="#nested-logit-model"></a>
</h3>
<p>A sometimes simpler approach, called <em>nested dichotomies</em>, is
to fit a collection of <span class="math inline">\(m-1\)</span> separate
models for each of a hierarchically nested set of binary comparisons
among the response categories. This is simpler,</p>
<ul>
<li>because it uses the familiar logistic regression model for each of
the dichotomies, where standard methods for model summaries and tests
are widely available.</li>
<li>Taken together, this set of <span class="math inline">\(m-1\)</span>
models comprises a complete model for the polytomous response, just as
does the multinomial logit model.</li>
</ul>
<p>This approach stems from <span class="citation">Fienberg
(1980)</span> and is described in <span class="citation">Fox
(2016)</span>, 14.2.2 and <span class="citation">Friendly &amp; Meyer
(2016)</span>, 8.2.</p>
<p>Moreover, by the construction of <strong>nested</strong> dichotomies,
the submodels are <span style="color: blue;">statistically
independent</span> (because the likelihood for the polytomous response
is the product of the likelihoods for the dichotomies), so that test
statistics, such as the likelihood ratio <span class="math inline">\(G^2\)</span> tests and tests for individual
coefficients can be added to give overall tests for the full polytomy.
In this way, the <span class="math inline">\(m-1\)</span> dichotomies
are analogous to <span class="math inline">\(m-1\)</span> <span style="color: blue;">orthogonal</span> contrasts for a for an <span class="math inline">\(m\)</span>-level factor in an ANOVA design.</p>
<p>Thus, when applicable, nested logit models give the best of two
worlds:</p>
<ul>
<li>
<strong>dichotomy models</strong>: Think about, analyze, plot the
separate model for each contrast among the response categories</li>
<li>
<strong>overall model</strong>: Summarize, analyze, plot the overall
model comprising all categories.</li>
</ul>
<p>Dichotomies are illustrated in the figure below, where response
categories <span class="math inline">\(Y = \{1, 2, 3, 4\}\)</span> can
be divided first as <span class="math inline">\(\{1, 2\}\)</span>
vs. <span class="math inline">\(\{3, 4\}\)</span>. Then these
dichotomies can be divided as <span class="math inline">\(\{1\}\)</span>
vs. <span class="math inline">\(\{2\}\)</span> and then <span class="math inline">\(\{3\}\)</span> vs. <span class="math inline">\(\{4\}\)</span>. Alternatively, as shown in the
right side of the figure, the response categories can be divided
progressively— first: <span class="math inline">\(\{1\}\)</span>
vs. <span class="math inline">\(\{2, 3, 4\}\)</span>, next: <span class="math inline">\(\{2\}\)</span> vs. <span class="math inline">\(\{3, 4\}\)</span>, and finally: <span class="math inline">\(\{3\}\)</span> vs. <span class="math inline">\(\{4\}\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="nested.jpg" alt="**Nested dichotomies**: The boxes show two different ways a four-category response can be represented as three nested dichotomies." width="80%"><p class="caption">
<strong>Nested dichotomies</strong>: The boxes show two different ways a
four-category response can be represented as three nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested.jpg")) -->
<p>This figure makes clear that nested dichotomies are not unique or
equivalent. Different choices will have different interpretations and
different fitted probabilities. Such models make the most sense when
there are substantive reasons for considering the response categories in
terms of such dichotomies. For example, in the diagram above at the
right, this would make sense if the categories were <em>ordered</em>,
<span class="math inline">\(1 &lt; 2 &lt; 3 &lt; 4\)</span>, so each of
the three submodels can be interpreted as <code>above_1</code>,
<code>above_2</code>, <code>above_3</code>. In this case, the scheme for
generating the dichotomies is often called <em>continuation logits</em>.
<!-- $\mathrm{above}: \{1, 2, 3}$. --></p>
<p>For another example, the figure below shows a case where psychiatric
patients are classified into four diagnostic categories. These might be
considered ordered categories and dichotomized as in the 4-category
above. However, it might make better sense to dichotomize the non-normal
groups into a comparison of the depressed and manic group
vs. schizophrenic and then a final contrast of the depressed and manic
categories. Then, a model predicting diagnosis can be interpreted in
terms of the log odds of being classed for each of the dichotomies. By
independence, ANOVA and coefficient tests for the full multi-category
response are based on the sums over the three dichotomies.</p>
<div class="figure" style="text-align: center">
<img src="nested-psychiatric.png" alt="**Psychiatric classification**: The figure shows how four diagnostic categories might be represented by nested dichotomies." width="70%"><p class="caption">
<strong>Psychiatric classification</strong>: The figure shows how four
diagnostic categories might be represented by nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested-psychiatric.png")) -->
</div>
</div>
<div class="section level2">
<h2 id="example-womens-labor-force-participation">Example: Women’s labor force participation<a class="anchor" aria-label="anchor" href="#example-womens-labor-force-participation"></a>
</h2>
<p>For a main example, we consider the data set <code>Womenlf</code>
from the <code>carData</code> package. This data gives the responses of
263 women from a 1977 survey carried out by the York University
Institute for Social Research <span class="citation">(Atkinson, Blishen,
Ornstein, &amp; Stevenson, 1984)</span>. The variables are:</p>
<ul>
<li>
<code>partic</code>: labor force participation, the response, with
levels:
<ul>
<li>
<code>fulltime</code>: working full-time</li>
<li>
<code>not.work</code>: not working outside the home</li>
<li>
<code>parttime</code> : working part-time.</li>
</ul>
</li>
<li>
<code>hincome</code>: Husband’s income, in $1,000s</li>
<li>
<code>children</code>: Presence of children in the home,
<code>absent</code> or <code>present</code>
</li>
<li>
<code>region</code>: Region of Canada (Atlantic, BC, Ontario,
Prairie, Quebec)</li>
</ul>
<p>The response, <code>partic</code> is a factor, but the levels are
ordered alphabetically. To correct this, we make it an ordered factor.
At that time, the majority of the 263 women surveyed were not
working.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Womenlf</span>, package <span class="op">=</span> <span class="st">"carData"</span><span class="op">)</span></span>
<span><span class="va">Womenlf</span> <span class="op">&lt;-</span> <span class="va">Womenlf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>partic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">partic</span>, </span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Womenlf</span><span class="op">$</span><span class="va">partic</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; not.work parttime fulltime </span></span>
<span><span class="co">#&gt;      155       42       66</span></span></code></pre></div>
<p>The question is: How can we understand these womens’ labor choices in
terms of the available variables?</p>
<div class="section level3">
<h3 id="defining-dichotomies">Defining dichotomies<a class="anchor" aria-label="anchor" href="#defining-dichotomies"></a>
</h3>
<p>It is at least arguable to consider a woman’s labor choice as first
involving a dichotomy (<code>work</code>) between women who are not
working vs. those who are (part time or full time). A second dichotomy
(<code>full</code>) contrasts those who work full time vs. part time,
but among only those who work.</p>
<p>The two binary variables can be created by re-coding
<code>partic</code> in the data frame as follows.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Womenlf</span> <span class="op">&lt;-</span> <span class="va">Womenlf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>work <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">partic</span><span class="op">==</span><span class="st">"not.work"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>full <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">work</span> <span class="op">&amp;</span> <span class="va">partic</span> <span class="op">==</span> <span class="st">"fulltime"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    <span class="va">work</span> <span class="op">&amp;</span> <span class="va">partic</span> <span class="op">==</span> <span class="st">"parttime"</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Note that the full sample of 263 cases is available for the
<code>work</code> dichotomy, while only 108 cases are involved in the
distinction between part time and full time work. The relations of
<code>partic</code> to these dichotomies can be seen below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">partic</span> <span class="op">+</span> <span class="va">work</span>, addNA<span class="op">=</span><span class="cn">TRUE</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt;           work</span></span>
<span><span class="co">#&gt; partic       0   1</span></span>
<span><span class="co">#&gt;   not.work 155   0</span></span>
<span><span class="co">#&gt;   parttime   0  42</span></span>
<span><span class="co">#&gt;   fulltime   0  66</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">partic</span> <span class="op">+</span> <span class="va">full</span>, addNA<span class="op">=</span><span class="cn">TRUE</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt;           full</span></span>
<span><span class="co">#&gt; partic       0   1 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   not.work   0   0  155</span></span>
<span><span class="co">#&gt;   parttime  42   0    0</span></span>
<span><span class="co">#&gt;   fulltime   0  66    0</span></span></code></pre></div>
<p>We could then fit the separate models for these dichotomies
manually:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod.work</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">work</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="va">mod.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">full</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span></code></pre></div>
<p>The two log odds models are:
<!-- equatiomatic::extract_eq(mod.work) -->
<!-- equatiomatic::extract_eq(mod.work) --></p>
<p><span class="math display">\[
L_1 =\log\left[ \frac { P( \operatorname{work} = \operatorname{1} ) }{ 1
- P( \operatorname{work} = \operatorname{1} ) } \right] = \alpha_1 +
\beta_{11}(\operatorname{hincome}) +
\beta_{12}(\operatorname{children}_{\operatorname{present}})
\]</span> <span class="math display">\[
L_2 = \log\left[ \frac { P( \operatorname{full} ) }{ 1 - P(
\operatorname{full} ) } \right] = \alpha_2 +
\beta_{21}(\operatorname{hincome}) +
\beta_{22}(\operatorname{children}_{\operatorname{present}})
\]</span> But then, it would be difficult to obtain tests for the
combined model, get and plot predicted values and so forth.</p>
</div>
<div class="section level3">
<h3 id="using-dichotomy-and-logits">Using <code>dichotomy()</code> and <code>logits()</code><a class="anchor" aria-label="anchor" href="#using-dichotomy-and-logits"></a>
</h3>
<p>Instead, the <code>nestedLogit</code> package provides an easier way.
The <code><a href="../reference/nestedLogit.html">dichotomy()</a></code> function creates a list of length two
defining a single dichotomy. The <code><a href="../reference/nestedLogit.html">logits()</a></code> function uses
<span class="math inline">\(m-1\)</span> calls to
<code><a href="../reference/nestedLogit.html">dichotomy()</a></code> to create a list of class
<code>dichotomies</code> containing the symbolic representation of these
contrasts among the response categories.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nestedLogit.html">logits</a></span><span class="op">(</span>work<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      full<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparisons</span></span>
<span><span class="co">#&gt; work: {not.work} vs. {parttime, fulltime}</span></span>
<span><span class="co">#&gt; full: {parttime} vs. {fulltime}</span></span></code></pre></div>
<p>For convenience, there are functions to convert these dichotomies to
a matrix or to a character string representing the tree structure of the
dichotomies.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      not.work parttime fulltime</span></span>
<span><span class="co">#&gt; work        0        1        1</span></span>
<span><span class="co">#&gt; full       NA        0        1</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "{{not.work}} {{parttime fulltime}}; {{parttime}} {{fulltime}}"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fitting-the-nested-logit-model">Fitting the nested logit model<a class="anchor" aria-label="anchor" href="#fitting-the-nested-logit-model"></a>
</h3>
<p>To fit the model, we specify these <code>comparisons</code> as the
<code>dichotomies</code> argument. The model formula,
<code>partic ~ hincome + children</code> specifies a main effects model
for husband’s income and presence of young children.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nestedLogit.html">nestedLogit</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, </span>
<span>                          dichotomies <span class="op">=</span> <span class="va">comparisons</span>,</span>
<span>                          data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span></code></pre></div>
<p>The result, <code>wlf.nested</code> is a list containing the details
of the model for the nested dichotomy. The <code>models</code> component
contains results equivalent to what was fit manually above as
<code>mod.work</code> and <code>mod.full</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "models"          "formula"         "dichotomies"     "data"           </span></span>
<span><span class="co">#&gt; [5] "data.name"       "subset"          "contrasts"       "contrasts.print"</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">$</span><span class="va">models</span><span class="op">)</span> <span class="co"># equivalent: names(models(wlf.models))</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "work" "full"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>As befits a model-fitting function, the package defines a nearly
complete set of methods for <code>"nestedLogit"</code> objects:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> print the results
for each of the submodels.</li>
<li>
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> re-fits the model, allowing changes to the
model <code>formula</code>, <code>data</code>, <code>subset</code>, and
<code>contrasts</code> arguments.</li>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> returns the coefficients for the predictors in
each dichotomy.</li>
<li>
<code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> returns the variance-covariance matrix of the
predictors.</li>
<li>
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> computes predicted probabilities for the
response categories, either for the cases in the data or for arbitrary
combinations of the predictors; the latter is useful for producing plots
to aid interpretation.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> are extensions of
<code><a href="https://broom.tidymodels.org/reference/glance.glm.html" class="external-link">broom::glance.glm()</a></code> and <code><a href="https://broom.tidymodels.org/reference/tidy.glm.html" class="external-link">broom::tidy.glm()</a></code> to
obtain compact summaries of a <code>"nestedLogit"</code> model
object.</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> provides basic plots of the predicted
probabilities over a range of values of the predictor variables.</li>
<li>
<code><a href="../reference/models.html">models()</a></code> is an extractor function for the binary logit
models in the <code>"nestedLogit"</code> object</li>
</ul>
<p>These are supplemented by various methods for testing hypotheses
about and comparing nested logit models:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> provides analysis-of-deviance Type I
(sequential) tests for each dichotomy and for the combined model. When
given a sequence of model objects, <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> tests the models
against one another in the order specified.</li>
<li>
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> uses <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> to provide
analysis-of-deviance Type II or III (partial) tests for each dichotomy
and for the combined model.</li>
<li>
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> computes Wald tests for hypotheses
about coefficients or their linear combinations.</li>
<li>
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> returns the log-likelihood and degrees of
freedom for the nested-dichotomies logit model.</li>
<li>Through <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>, the <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code> and
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code> functions compute the Akaike and Bayesian information
criteria model-comparison statistics.</li>
</ul>
<p>We illustrate some of these:</p>
<p><strong>Coefficients</strong>: By default, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>
returns a matrix whose rows are the terms in the model and whose columns
represent the nested dichotomies. The coefficients, <span class="math inline">\(\mathbf{\beta_{i1}}\)</span> give the changes in
the log odds of working vs. not working associated with a $1,000
increase in husband’s income and with having children present
vs. absent. <span class="math inline">\(\mathbf{\beta_{i2}}\)</span> is
similar for the log odds of working full time vs. part time among those
who are working. <span class="math inline">\(e^\mathbf{\beta}\)</span>
give the multiples of the odds for these comparisons.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     work    full</span></span>
<span><span class="co">#&gt; (Intercept)      1.33583  3.4778</span></span>
<span><span class="co">#&gt; hincome         -0.04231 -0.1073</span></span>
<span><span class="co">#&gt; childrenpresent -1.57565 -2.6515</span></span>
<span></span>
<span><span class="co"># show as odds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   work     full</span></span>
<span><span class="co">#&gt; (Intercept)     3.8032 32.38753</span></span>
<span><span class="co">#&gt; hincome         0.9586  0.89829</span></span>
<span><span class="co">#&gt; childrenpresent 0.2069  0.07055</span></span></code></pre></div>
<p>Thus, the odds of both working and working full time decrease with
husband’s income. Having young children also decreases the odds of
both.</p>
<p><strong>Anova</strong>: Extends <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> from the
<code>car</code> package <span class="citation">(Fox, Weisberg, &amp;
Price, 2023)</span>, It gives Type II tests for each term in the model.
Note that the <code>LR</code> <span class="math inline">\(\chi^2\)</span> and <code>df</code> for the
<code>Combined Responses</code> is the sum of their values for the
separate dichotomies.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. {parttime, fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      4.83  1      0.028 *  </span></span>
<span><span class="co">#&gt; children    31.32  1    2.2e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome       9.0  1     0.0027 ** </span></span>
<span><span class="co">#&gt; children     32.1  1    1.4e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      13.8  2      0.001 ** </span></span>
<span><span class="co">#&gt; children     63.5  2    1.7e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>linearHypothesis</strong>: For a given model,
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">car::linearHypothesis()</a></code> provides a very general method for
testing specific hypotheses about individual coefficients in a model or
their linear combinations. This is extended here in the
<code>linearHypothesis</code> method for <code>"nestedLogit"</code>
models.</p>
<p>For example, the following call tests the hypothesis that the
coefficients for <code>hincome</code> and <code>children</code> are
simultaneously all equal to zero. This is equivalent to the test of the
global null model, <span class="math inline">\(H_0 : \mathbf{B} =
0\)</span> against an alternative that one or more coefficients <span class="math inline">\(\beta_{ij} \ne 0\)</span>.</p>
<p><code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> gives these tests for each of the
submodels, <code>work</code>, <code>full</code> as well as for the
combined model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hincome"</span>, <span class="st">"childrenpresent"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear hypothesis test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hypothesis: </span></span>
<span><span class="co">#&gt; hincome = 0 </span></span>
<span><span class="co">#&gt; childrenpresent = 0 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Model 1: restricted model</span></span>
<span><span class="co">#&gt; Model 2: partic ~ hincome + children </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. {parttime, fulltime} </span></span>
<span><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; 1    262                        </span></span>
<span><span class="co">#&gt; 2    260  2  32.2      1e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; 1    107                        </span></span>
<span><span class="co">#&gt; 2    105  2  25.6    2.8e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt; Chisq = 57.813, Df = 4, Pr(&gt;Chisq) = 8.4e-12</span></span></code></pre></div>
<p><strong>glance</strong> and <strong>tidy</strong>: The
<code>broom</code> package <span class="citation">(Robinson, Hayes,
&amp; Couch, 2023)</span> provides some methods for giving compact and
tidy summaries of fitted models. The <code>glance</code> method for a
<code>"nestedLogit"</code> model gives a one-line summary of the
statistics for each dichotomy. The <code>tidy</code> method combines the
coefficients for the sub-models, together with test statistics.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span>   <span class="co"># summarize the sub-models</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   response null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> work              356.     262 -<span style="color: #BB0000;">160.</span>   326.  336.     320.         260   263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> full              144.     107  -<span style="color: #BB0000;">52.2</span>  110.  119.     104.         105   108</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span>     <span class="co"># summarize the coefficients</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   response term            estimate std.error statistic      p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> work     (Intercept)       1.34      0.384       3.48 0.000<span style="text-decoration: underline;">500</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> work     hincome          -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">3</span>    0.019<span style="text-decoration: underline;">8</span>     -<span style="color: #BB0000;">2.14</span> 0.032<span style="text-decoration: underline;">4</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> work     childrenpresent  -<span style="color: #BB0000;">1.58</span>      0.292      -<span style="color: #BB0000;">5.39</span> 0.000<span style="text-decoration: underline;">000</span>070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> full     (Intercept)       3.48      0.767       4.53 0.000<span style="text-decoration: underline;">005</span>80  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> full     hincome          -<span style="color: #BB0000;">0.107</span>     0.039<span style="text-decoration: underline;">2</span>     -<span style="color: #BB0000;">2.74</span> 0.006<span style="text-decoration: underline;">15</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> full     childrenpresent  -<span style="color: #BB0000;">2.65</span>      0.541      -<span style="color: #BB0000;">4.90</span> 0.000<span style="text-decoration: underline;">000</span>957</span></span></code></pre></div>
<p>These functions make it easy to construct custom tables. For example,
to extract the likelihood ratio <code>deviance</code> (<span class="math inline">\(G^2\)</span>) goodness-of fit tests and compute
(<span class="math inline">\(G^2 / df\)</span>), you could do:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="va">gl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">deviance</span>, <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>response <span class="op">=</span> <span class="st">"Combined"</span>, deviance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gl</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span>, df.residual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gl</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    `P-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">deviance</span>, <span class="va">df.residual</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    `$G^2$/df` <span class="op">=</span> <span class="va">deviance</span> <span class="op">/</span> <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>`$G^2$` <span class="op">=</span> <span class="va">deviance</span>,</span>
<span>         df <span class="op">=</span> <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">response</th>
<th align="right"><span class="math inline">\(G^2\)</span></th>
<th align="right">df</th>
<th align="right">P-value</th>
<th align="right">
<span class="math inline">\(G^2\)</span>/df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">work</td>
<td align="right">319.7</td>
<td align="right">260</td>
<td align="right">0.007</td>
<td align="right">1.230</td>
</tr>
<tr class="even">
<td align="left">full</td>
<td align="right">104.5</td>
<td align="right">105</td>
<td align="right">0.496</td>
<td align="right">0.995</td>
</tr>
<tr class="odd">
<td align="left">Combined</td>
<td align="right">424.2</td>
<td align="right">365</td>
<td align="right">0.018</td>
<td align="right">1.162</td>
</tr>
</tbody>
</table>
<p><strong>update</strong>: Makes it easy to create a new model from an
old one, by adding/subtracting terms from the model formula or changing
the observations used or contrasts for factors.</p>
<p>For example: You might ask: “<em>Does it make sense to include
<code>region</code> of Canada in the model?</em>”<br>
This can be tested by adding it to the model formula, and comparing the
new model with the original one using <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>. The
significance tests here are for the additional contribution of
<code>region</code> over the model that just includes main effects of
<code>husincome</code> and <code>children</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">wlf.nested</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">region</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="va">wlf.nested.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span><span class="co">#&gt;  Model 2: partic ~ hincome + children + region </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. {parttime, fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       260        320                     </span></span>
<span><span class="co">#&gt; 2       256        317  4     2.43     0.66</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       105        104                     </span></span>
<span><span class="co">#&gt; 2       101        102  4     2.65     0.62</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       365        424                     </span></span>
<span><span class="co">#&gt; 2       357        419  8     5.08     0.75</span></span></code></pre></div>
<p>Note that <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> with two or models tests these against
one another, in the order specified. This assumes that the models
compared are <em>nested</em> (an unintentional a pun), in the sense that
the terms in the smaller model are a subset of those in the larger
model.</p>
<p>In a similar way, we could fit and test a <em>larger</em> scope of
models. For example to add an interaction between husband’s income and
children:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">wlf.nested</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="va">wlf.nested.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span><span class="co">#&gt;  Model 2: partic ~ hincome + children + hincome:children </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. {parttime, fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       260        320                     </span></span>
<span><span class="co">#&gt; 2       259        319  1    0.608     0.44</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       105        104                     </span></span>
<span><span class="co">#&gt; 2       104        104  1    0.256     0.61</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       365        424                     </span></span>
<span><span class="co">#&gt; 2       363        423  2    0.864     0.65</span></span></code></pre></div>
<p>We can see neither <code>region</code> nor an interaction make a
difference in goodness of fit of either of the sub-models or the
combined model for the three response categories.</p>
</div>
</div>
<div class="section level2">
<h2 id="obtaining-fitted-values-predict">Obtaining fitted values: <code>predict()</code><a class="anchor" aria-label="anchor" href="#obtaining-fitted-values-predict"></a>
</h2>
<p>By default, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> for a <code>"nestedLogit"</code>
model object returns the predicted probabilities
(<code>type = "response"</code>) of each of the response categories for
<em>all</em> observations in the data set. Note that the computation is
a bit tricky, because the probabilities of working full time or part
time are conditional on working outside the home.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/some.html" class="external-link">some</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     not.work parttime fulltime</span></span>
<span><span class="co">#&gt; 13    0.6504  0.18696  0.16268</span></span>
<span><span class="co">#&gt; 27    0.7396  0.20070  0.05974</span></span>
<span><span class="co">#&gt; 134   0.3222  0.08251  0.59525</span></span>
<span><span class="co">#&gt; 137   0.6968  0.20093  0.10226</span></span>
<span><span class="co">#&gt; 143   0.6693  0.19426  0.13640</span></span>
<span><span class="co">#&gt; 182   0.3410  0.09661  0.56240</span></span>
<span><span class="co">#&gt; 198   0.7925  0.18197  0.02556</span></span>
<span><span class="co">#&gt; 212   0.6878  0.19929  0.11291</span></span>
<span><span class="co">#&gt; 242   0.3131  0.07607  0.61087</span></span>
<span><span class="co">#&gt; 257   0.2225  0.02865  0.74886</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>The <code>nestedLogit</code> package has a basic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
method for <code>"nestedLogit"</code> models. It calculates fitted
probabilities for the response categories and plots these against a
single explanatory variable on the horizontal axis and
<code>other</code> explanatory variables fixed to particular values. To
produce multi-panel plots, it is necessary to call this repeatedly for
levels of other variables, and compose these into a single figure using
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> (or <code>knitr</code> chunk options):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"absent"</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend.location<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"present"</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-plot-1.png" alt="**plot method**: Predicted probabilities of working at all or working part time or full time" width="100%"><p class="caption">
<strong>plot method</strong>: Predicted probabilities of working at all
or working part time or full time
</p>
</div>
<div class="section level3">
<h3 id="constructing-plots">Constructing plots<a class="anchor" aria-label="anchor" href="#constructing-plots"></a>
</h3>
<p>To explain how this works, and for better control of the details, it
is useful to describe how this can be done directly.</p>
<p>To construct a plot, it is sufficient to calculate predicted
probabilities over a grid of values of the predictor variables. Here, we
select a range of 0 - 45 in steps of 5, combined with the two values of
<code>children</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>hincome<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>                   children<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"absent"</span>, <span class="st">"present"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred.nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.nested</span>, newdata <span class="op">=</span> <span class="va">new</span><span class="op">)</span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">new</span>, <span class="va">pred.nested</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">plotdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   hincome children not.work parttime fulltime</span></span>
<span><span class="co">#&gt; 1       0   absent   0.2082  0.02372   0.7681</span></span>
<span><span class="co">#&gt; 2       5   absent   0.2452  0.03785   0.7169</span></span>
<span><span class="co">#&gt; 3      10   absent   0.2864  0.05907   0.6545</span></span>
<span><span class="co">#&gt; 4      15   absent   0.3315  0.08936   0.5791</span></span>
<span><span class="co">#&gt; 5      20   absent   0.3800  0.12944   0.4906</span></span>
<span><span class="co">#&gt; 6      25   absent   0.4309  0.17691   0.3922</span></span></code></pre></div>
<p>Because the fitted values are in multiple columns, it is easiest to
plot these using <code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot()</a></code>. We could plot these all in a
single (messy) figure, but it is clearer to show separate panels for
children <code>absent</code> and <code>present</code>.</p>
<p>To do this, the <code>plotdata</code> data set is subset within a
loop over the values of <code>children</code> and each subset is plotted
by <code>matplot</code>. It is only necessary to include the legend in
one panel. The plots are combined into a single figure using
<code>par(mfrow())</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"magenta"</span>, <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">kids</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"absent"</span>, <span class="st">"present"</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">plotdata</span>, <span class="va">children</span><span class="op">==</span><span class="va">kids</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="st">"hincome"</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, col <span class="op">=</span> <span class="va">cols</span>,</span>
<span>          xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, </span>
<span>          ylab<span class="op">=</span><span class="st">'Fitted Probability'</span>,</span>
<span>          main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Children"</span>, <span class="va">kids</span><span class="op">)</span>,</span>
<span>          cex.lab <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">kids</span><span class="op">==</span><span class="st">"absent"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="va">cols</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>           legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fulltime"</span>, <span class="st">"parttime"</span>, <span class="st">"not working"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-matplot-1.png" alt="**matplot**: Predicted probabilities of working at all or working part time or full time" width="100%"><p class="caption">
<strong>matplot</strong>: Predicted probabilities of working at all or
working part time or full time
</p>
</div>
</div>
<div class="section level3">
<h3 id="using-ggplot">Using <code>ggplot</code><a class="anchor" aria-label="anchor" href="#using-ggplot"></a>
</h3>
<p>More control, and perhaps a more aesthetically pleasing figure can be
produced using <code>ggplot</code> <span class="citation">(Wickham et
al., 2023)</span>. However, <code>ggplot</code> wants the data in long
format. That makes it easy to plot probability against one predictor and
use <code>color</code> to distinguish the levels of <code>partic</code>
and facet the plot by <code>children</code>.
<!-- (The result of `tidyr::pivot_longer()` doesn't recognize an ordered nature of `"Working"`, -->
<!-- so this must be done in a separate step.) --></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotlong</span> <span class="op">&lt;-</span> <span class="va">plotdata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">fulltime</span> <span class="op">:</span> <span class="va">not.work</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Working"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Working <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">Working</span>, </span>
<span>                           levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">plotlong</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   hincome children Working  Probability</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       0 absent   fulltime      0.768 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       0 absent   parttime      0.023<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       0 absent   not.work      0.208 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       5 absent   fulltime      0.717 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5 absent   parttime      0.037<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       5 absent   not.work      0.245</span></span></code></pre></div>
<p>Then, one call to <code>ggplot</code> produces both panels. To sort
the levels of <code>Working</code> appropriately, we made this an
ordered factor in the step above, but assign the colors with a discrete
scale.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plotlong</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hincome</span>, y<span class="op">=</span><span class="va">Probability</span>, color<span class="op">=</span><span class="va">Working</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Husband's Income"</span>, y<span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">children</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-1.png" alt="**ggplot**: Predicted probabilities of working at all or working part time or full time" width="100%"><p class="caption">
<strong>ggplot</strong>: Predicted probabilities of working at all or
working part time or full time
</p>
</div>
</div>
<div class="section level3">
<h3 id="direct-labels">Direct labels<a class="anchor" aria-label="anchor" href="#direct-labels"></a>
</h3>
<p>It’s usually nicer to label the curves directly than to rely on a
legend. <!-- The `directlabels` package [@R-directlabels] -->
<!-- can take a `ggplot` object, remove the legend and -->
<!-- place labels along the curves. It is a little fiddly, and we haven't tried -->
<!-- to make it avoid clipping some of the labels. --></p>
<!-- ```{r wlf-directlabels} -->
<!-- #| out.width = "100%", -->
<!-- #| fig.height = 4, -->
<!-- #| fig.cap = "**direct labels**: Predicted probabilities, with labels on the curves" -->
<!-- direct.label(gg, list("top.bumptwice", dl.trans(y = y + 0.2))) -->
<!-- ``` -->
<p>The <code>geomtextpath</code> <span class="citation">(Cameron &amp;
van den Brand, 2022)</span> package offers <code><a href="https://allancameron.github.io/geomtextpath/reference/geom_textpath.html" class="external-link">geom_textline()</a></code>
as an alternative to <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> that adds a text label to
a curve.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plotlong</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hincome</span>, y<span class="op">=</span><span class="va">Probability</span>, color<span class="op">=</span><span class="va">Working</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://allancameron.github.io/geomtextpath/reference/geom_textpath.html" class="external-link">geom_textline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Working</span><span class="op">)</span>,</span>
<span>                linewidth <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                hjust <span class="op">=</span> <span class="fl">0.9</span>, vjust <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Husband's Income"</span>, y<span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">children</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-geomtextpath-1.png" alt="**geomtextpath**: Predicted probabilities, with labels on the curves" width="100%"><p class="caption">
<strong>geomtextpath</strong>: Predicted probabilities, with labels on
the curves
</p>
</div>
</div>
<div class="section level3">
<h3 id="plotting-fitted-log-odds">Plotting fitted log odds<a class="anchor" aria-label="anchor" href="#plotting-fitted-log-odds"></a>
</h3>
<p>It is sometimes easier to interpret logistic regression models by
plotting the linear predictors on the <strong>log odds</strong> scale,
because these appear as straight lines. That is, from the estimated
coefficients in the model, the predicted log odds of <code>work</code>
and <code>full</code> are given by</p>
<!-- equatiomatic::extract_eq(wlf.nested$models[[1]], use_coefs = TRUE) -->
<!-- equatiomatic::extract_eq(wlf.nested$models[[2]], use_coefs = TRUE) -->
<p><span class="math display">\[
L_1 =\log\left[ \frac { \widehat{P( \operatorname{work} =
\operatorname{1} )} }{ 1 - \widehat{P( \operatorname{work} =
\operatorname{1} )} } \right] = 1.34 - 0.04(\operatorname{hincome}) -
1.58(\operatorname{children}_{\operatorname{present}})
\]</span></p>
<p><span class="math display">\[
L_2 =\log\left[ \frac { \widehat{P( \operatorname{full} =
\operatorname{1})} }{ 1 - \widehat{P( \operatorname{full} =
\operatorname{1})} } \right] = 3.48 - 0.11(\operatorname{hincome}) -
2.65(\operatorname{children}_{\operatorname{present}})
\]</span> Here, <span class="math inline">\(\operatorname{children}_{\operatorname{present}}\)</span>
is either 0 or 1, so this amounts to a shift in the intercept when
children are present.</p>
<p>These values can be calculated by calling <code><a href="https://rdrr.io/r/stats/predict.glm.html" class="external-link">predict.glm()</a></code>
directly for the <code>models</code> component of
<code>wlf.nested</code>, specifying <code>type = "link"</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred.logits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/models.html">models</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span>, <span class="va">predict</span>, newdata<span class="op">=</span><span class="va">new</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span><span class="va">plotdatal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">new</span>, <span class="va">pred.logits</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">plotdatal</span><span class="op">)</span></span>
<span><span class="co">#&gt;   hincome children   work   full</span></span>
<span><span class="co">#&gt; 1       0   absent 1.3358 3.4778</span></span>
<span><span class="co">#&gt; 2       5   absent 1.1243 2.9414</span></span>
<span><span class="co">#&gt; 3      10   absent 0.9127 2.4051</span></span>
<span><span class="co">#&gt; 4      15   absent 0.7012 1.8688</span></span>
<span><span class="co">#&gt; 5      20   absent 0.4897 1.3324</span></span>
<span><span class="co">#&gt; 6      25   absent 0.2781 0.7961</span></span></code></pre></div>
<p>Then we plot these more or less as before:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">kids</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"absent"</span>, <span class="st">"present"</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">plotdatal</span>, <span class="va">children</span><span class="op">==</span><span class="va">kids</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="st">"hincome"</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="va">cols</span>,</span>
<span>          xlab<span class="op">=</span><span class="st">"Husband's Income"</span>,</span>
<span>          ylab<span class="op">=</span><span class="st">'Predicted Log Odds'</span>,</span>
<span>          main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Children"</span>, <span class="va">kids</span><span class="op">)</span>,</span>
<span>          cex.lab <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">kids</span><span class="op">==</span><span class="st">"absent"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="va">cols</span>, bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>           title <span class="op">=</span> <span class="st">"Dichotomy"</span>,</span>
<span>           legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"work"</span>, <span class="st">"full"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-logits-1.png" alt="**log odds**: Predicted logits of the  `work` and `full` dichotomies" width="100%"><p class="caption">
<strong>log odds</strong>: Predicted logits of the <code>work</code> and
<code>full</code> dichotomies
</p>
</div>
<p>Finally, we can use <code>ggplot</code> as before to plot the fitted
logits, first transforming the long format.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotlongl</span> <span class="op">&lt;-</span> <span class="va">plotdatal</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">work</span> <span class="op">:</span> <span class="va">full</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Dichotomy"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Dichotomy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">Dichotomy</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"work"</span>, <span class="st">"full"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>Doing this gives the flexibility that we can facet the plot either by
<code>children</code> (as before) or <code>Dichotomy</code>. The latter
nicely shows that the additive model has equal slopes for husband’s
income within both panels: increasing husband’s income decreases the log
odds of working, but at a faster rate for the <code>full</code>
dichotomy. Having young children decreases the log odds of working
either at all or working fulltime as compared to parttime.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plotlongl</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hincome</span>, y<span class="op">=</span><span class="va">logit</span>, color<span class="op">=</span><span class="va">children</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span>, shape <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Husband's Income"</span>, y<span class="op">=</span> <span class="st">"Log Odds"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Dichotomy</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.35</span>, <span class="fl">.82</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-gglogits-1.png" alt="**log odds**: Predicted logits of the  `work` and `full` dichotomies" width="100%"><p class="caption">
<strong>log odds</strong>: Predicted logits of the <code>work</code> and
<code>full</code> dichotomies
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write a packages.bib file of the packages (.packages()) that have been used here</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">to.cite</span>, <span class="fu"><a href="https://rdrr.io/r/base/zpackages.html" class="external-link">.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/write_bib.html" class="external-link">write_bib</a></span><span class="op">(</span><span class="va">pkgs</span>, file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"packages.bib"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Atkinson-etal:1984" class="csl-entry">
Atkinson, T., Blishen, B. R., Ornstein, M. D., &amp; Stevenson, H. M.
(1984). <span class="nocase">Quality of Canadian Life: Social Change in
Canada</span>, 1977. ICPSR - Interuniversity Consortium for Political;
Social Research. http://doi.org/<a href="https://doi.org/10.3886/ICPSR07879.V1" class="external-link">10.3886/ICPSR07879.V1</a>
</div>
<div id="ref-R-geomtextpath" class="csl-entry">
Cameron, A., &amp; van den Brand, T. (2022). <em>Geomtextpath: Curved
text in ggplot2</em>. Retrieved from <a href="https://allancameron.github.io/geomtextpath/" class="external-link">https://allancameron.github.io/geomtextpath/</a>
</div>
<div id="ref-Fienberg:80" class="csl-entry">
Fienberg, S. E. (1980). <em>The analysis of cross-classified categorical
data</em> (2nd ed.). Cambridge, MA: MIT Press.
</div>
<div id="ref-Fox:2016:ARA" class="csl-entry">
Fox, J. (2016). <em>Applied regression analysis and generalized linear
models</em> (Third edition.). Los Angeles: SAGE.
</div>
<div id="ref-R-car" class="csl-entry">
Fox, J., Weisberg, S., &amp; Price, B. (2023). <em>Car: Companion to
applied regression</em>. Retrieved from <a href="https://CRAN.R-project.org/package=car" class="external-link">https://CRAN.R-project.org/package=car</a>
</div>
<div id="ref-FriendlyMeyer:2016:DDAR" class="csl-entry">
Friendly, M., &amp; Meyer, D. (2016). <em>Discrete data analysis with
<span>R</span>: Visualization and modeling techniques for categorical
and count data</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.
</div>
<div id="ref-R-nnet" class="csl-entry">
Ripley, B. (2022). <em>Nnet: Feed-forward neural networks and
multinomial log-linear models</em>. Retrieved from <a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">http://www.stats.ox.ac.uk/pub/MASS4/</a>
</div>
<div id="ref-R-broom" class="csl-entry">
Robinson, D., Hayes, A., &amp; Couch, S. (2023). <em>Broom: Convert
statistical objects into tidy tibbles</em>. Retrieved from <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, H., Chang, W., Henry, L., Pedersen, T. L., Takahashi, K.,
Wilke, C., … Dunnington, D. (2023). <em>ggplot2: Create elegant data
visualisations using the grammar of graphics</em>. Retrieved from <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">https://CRAN.R-project.org/package=ggplot2</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
