<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nested-dichotomies logistic regression models • nestedLogit</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested-dichotomies logistic regression models"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nestedLogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/nestedLogit.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plotting-ggplot.html">Plotting nestedLogit models with ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/standard-errors.html">Standard Errors of Fitted Category Probabilities by the Delta Method for the Nested Logit Model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/nestedLogit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Nested-dichotomies logistic regression models</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly and John Fox</h4>
            
            <h4 data-toc-skip class="date">2026-02-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/nestedLogit/blob/HEAD/vignettes/nestedLogit.Rmd" class="external-link"><code>vignettes/nestedLogit.Rmd</code></a></small>
      <div class="d-none name"><code>nestedLogit.Rmd</code></div>
    </div>

    
    
<p>Load the packages we’ll use here:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(nestedLogit)    <span class="co"># Nested Dichotomy Logistic Regression Models</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(knitr)          <span class="co"># A General-Purpose Package for Dynamic Report Generation in R</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(car)            <span class="co"># Companion to Applied Regression</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(nnet)           <span class="co"># Feed-Forward Neural Networks and Multinomial Log-Linear Models</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(broom)          <span class="co"># Convert Statistical Objects into Tidy Tibbles</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)          <span class="co"># A Grammar of Data Manipulation</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(effects)        <span class="co"># Effect Displays for Linear, Generalized Linear, and Other Models</span></span></code></pre></div>
<div id="models-for-polytomous-responses" class="section level2">
<h2>Models for polytomous responses</h2>
<p>The familiar logistic-regression model applies when there is a binary
(“<em>dichotomous</em>”) response, such as “survived” vs. “died”, or
voted “yes” vs. “no” on a referendum. Often, however, the response
variable is multi-category (“<em>polytomous</em>”), taking on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m &gt; 2</annotation></semantics></math>
discrete values. For example,</p>
<ul>
<li><p>Respondents to a social survey are classified by their highest
completed level of education, taking on the values (1) less than
highschool, (2) highschool graduate, (3) some post-secondary, or (4)
post-secondary degree.</p></li>
<li><p>Women’s labor-force participation is classified as (1) not
working outside the home, (2) working part-time, or (3) working
full-time.</p></li>
<li><p>Voters in Quebec in a Canadian national election choose one of
the (1) Liberal Party, (2) Conservative Party, (3) New Democratic Party,
or (4) Bloc Quebecois.</p></li>
</ul>
<p>The numbers in these examples, (1), (2), etc., are category labels,
and the categories may be ordered (as in the first two examples) or may
not (as in the third).</p>
<p>There are several different ways to model the category probabilities
for a polytomous response. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≡</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>x</mi><mo accent="true">→</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_{ij} \equiv \phi_j \,  ( \vec{x}_i )</annotation></semantics></math>
be the probability of response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
for case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
given the predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>x</mi><mo accent="true">→</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\vec{x}_i</annotation></semantics></math>.
Because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>j</mi></msub><mspace width="0.167em"></mspace><msub><mi>ϕ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_j \,  \phi_{ij} = 1</annotation></semantics></math>,
any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m - 1</annotation></semantics></math>
of these probabilities imply the last; for example,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mspace width="0.167em"></mspace><msub><mi>ϕ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\phi_{im} = 1 - \sum_{j = 1}^{m - 1} \,  \phi_{ij}</annotation></semantics></math>.</p>
<p>The essential idea is to construct a model for the polytomous
response composed of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
logit comparisons among the response categories in a manner analogous to
to the treatment of factors in the predictor variables. There are also
more restrictive models specifically for ordered categorical responses,
but we will not consider them here.</p>
<div id="multinomial-logit-model" class="section level3">
<h3>Multinomial logit model</h3>
<p>One natural generalization of the the standard logistic-regression
(or <em>logit</em>) model is the <em>multinomial logit</em> (or
<em>generalized logit</em>) model. When the polytomous response has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
levels, the multinomial logit model comprises
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
log-odds comparisons with a reference level, typically the first or
last, as described in <span class="citation">Fox (2016, sec.
14.2.1)</span> and <span class="citation">Friendly &amp; Meyer (2016,
sec. 8.3)</span>. This is an inessential choice, in that the likelihood
under the model and the fitted response probabilities that it produces
are unaffected by choice of reference level, much as choice of reference
level for dummy regressors created from a factor predictor doesn’t
affect the fit of a regression model. The standard implementation of
this model in R is <code>multinom()</code> in the <strong>nnet</strong>
package <span class="citation">(Venables &amp; Ripley, 2002)</span>,
which takes the first level of the response as the omitted reference
category.</p>
</div>
<div id="nested-dichotomies-logit-model" class="section level3">
<h3>Nested-dichotomies logit model</h3>
<p>Because it uses the familiar dichotomous logit model, fitting
separate models for each of a hierarchically nested set of binary
comparisons among the response categories, the
<em>nested-dichotomies</em> logit model can be a simpler alternative to
the multinomial logit model. Standard methods for model summaries, tests
and graphs can then be employed for each of the constituent binary logit
models, and taken together, the set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
models comprises a complete model for the polytomous response, just as
the multinomial logit model does. This approach is described by <span
class="citation">Fienberg (1980)</span> and is also discussed by <span
class="citation">Fox (2016, sec. 14.2.2)</span> and <span
class="citation">Friendly &amp; Meyer (2016, sec. 8.2)</span>.</p>
<p>For an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>-category
response and a model-matrix with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
regressors, both the nested-dichotomies logit model and the multinomial
logit model have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p \times (m - 1)</annotation></semantics></math>
parameters. The models are not equivalent, however, in that they
generally produce different sets of fitted category probabilities and
hence different likelihoods.</p>
<p>By the construction of nested dichotomies, the submodels are
statistically independent (because the likelihood for the polytomous
response is the product of the likelihoods for the dichotomies), so test
statistics, such as likelihood ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>)
and Wald chi-square tests for regression coefficients can be summed to
give overall tests for the full polytomy. In this way, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
dichotomies are analogous to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
orthogonal contrasts for an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>-level
factor in a balanced ANOVA design.</p>
<p>Alternative sets of nested dichotomies are illustrated in the figure
below, for a four-category polytomous response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Y = \{1, 2, 3, 4\}</annotation></semantics></math>.
In the case shown at the left of the figure, the response categories are
divided first as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1, 2\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3, 4\}</annotation></semantics></math>.
Then these compound categories are subdivided as the dichotomies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{2\}</annotation></semantics></math>
and as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{4\}</annotation></semantics></math>.
Alternatively, as shown at the right of the figure, the response
categories are divided progressively: first as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{2, 3, 4\}</annotation></semantics></math>;
next as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{2\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3, 4\}</annotation></semantics></math>;
and and finally
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{4\}</annotation></semantics></math>.</p>
<div class="figure" style="text-align: center">
<img src="nested.jpg" class="r-plt" alt="**Nested dichotomies**: The boxes show two different ways a four-category response can be represented as three nested dichotomies." width="80%" />
<p class="caption">
<strong>Nested dichotomies</strong>: The boxes show two different ways a
four-category response can be represented as three nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested.jpg")) -->
<p>This example makes clear that nested dichotomies are not unique and
that alternative sets of nested dichotomies are not equivalent:
Different choices have different interpretations. Moreover, and more
fundamentally, fitted probabilities and hence the likelihood for the
nested-dichotomies model depend on how the nested dichotomies are
defined.</p>
<p>The nested-dichotomies model is consequently most compelling when
there is a natural and unique way to define the dichotomies, such as a
process that proceeds through an orderly sequence of stages. Consider
the set of nested dichotomies at the right of the figure above, and the
previously mentioned four-level educational response variable with
categories (1) less than highschool, (2) highschool graduate, (3) some
post-secondary, and (4) post-secondary degree. In the vast majority of
cases, individuals proceed through these educational stages in sequence.
The first dichotomy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{2, 3, 4\}</annotation></semantics></math>,
therefore represents highschool graduation; the second,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{2\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3, 4\}</annotation></semantics></math>,
enrollment in post-secondary education; and the third,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{3\}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>4</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{4\}</annotation></semantics></math>,
completion of a post-secondary degree. This scheme for generating the
logits for the nested-dichotomies model is termed <em>continuation
logits</em>.</p>
<p>To take another example, the figure below shows the classification of
psychiatric patients into four diagnostic categories. These might be
naturally dichotomized by contrasting the normal individuals to the
groups of patients, and then dividing the patient groups into a
comparison of depressed and manic patients vs. schizophrenics, followed
by a comparison of depressed vs. manic patients. A model predicting
diagnosis can be interpreted in terms of the probabilities of
classification into each of the response categories.</p>
<div class="figure" style="text-align: center">
<img src="nested-psychiatric.png" class="r-plt" alt="**Psychiatric classification**: The figure shows how four diagnostic categories might be represented by nested dichotomies." width="70%" />
<p class="caption">
<strong>Psychiatric classification</strong>: The figure shows how four
diagnostic categories might be represented by nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested-psychiatric.png")) -->
</div>
</div>
<div id="example-womens-labor-force-participation"
class="section level2">
<h2>Example: Women’s labor-force participation</h2>
<p>For a principal example, we consider the data set
<code>Womenlf</code> from the <strong>carData</strong> package <span
class="citation">(Fox, Weisberg, &amp; Price, 2022)</span>. The data
give the responses of 263 young married women, 21–30 years old, drawn
from a 1977 survey carried out by the York University Institute for
Social Research <span class="citation">(Atkinson, Blishen, Ornstein,
&amp; Stevenson, 1984)</span>. This example was originally developed by
<span class="citation">Fox (1984, sec. 5.1.5)</span>. The variables in
the model are:</p>
<ul>
<li><code>partic</code>: labor force participation, the response, with
levels:
<ul>
<li><code>"fulltime"</code>: working full-time</li>
<li><code>"not.work"</code>: not working outside the home</li>
<li><code>"parttime"</code> : working part-time.</li>
</ul></li>
<li><code>hincome</code>: Husband’s income, in $1,000s.</li>
<li><code>children</code>: Presence of children in the home,
<code>"absent"</code> or <code>"present"</code>.</li>
<li><code>region</code>: Region of Canada (“Atlantic”, “BC”, “Ontario”,
“Prairie”, “Quebec”).</li>
</ul>
<p>The response, <code>partic</code> is a factor, but the levels are
ordered alphabetically. To facilitate interpretation, we reorder the
levels of <code>partic</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(Womenlf, <span class="at">package =</span> <span class="st">&quot;carData&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>Womenlf<span class="sc">$</span>partic <span class="ot">&lt;-</span> <span class="fu">with</span>(Womenlf, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                       <span class="fu">factor</span>(partic, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>)))</span></code></pre></div>
<p>In 1977, the majority of the 263 women in the sample were not working
outside the home:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> partic, <span class="at">data=</span>Womenlf)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; partic</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; not.work parttime fulltime </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;      155       42       66</span></span></code></pre></div>
<div id="defining-nested-dichotomies" class="section level3">
<h3>Defining nested dichotomies</h3>
<p>How can we understand these womens’ labor-force participation choices
in terms of the explanatory variables? We’ll consider three polytomous
logit models for the <code>Womenlf</code> data, two of which entail
different choices of nested dichotomies, and the multinomial logit
model. The example will illustrate the potential pitfalls and advantages
of the nested-dichotomies approach in a context where there isn’t a
compelling choice of nested dichotomies.</p>
<p>It is at least arguable to construe a woman’s labor-force choice as
first involving a dichotomy (let’s call it <code>work</code>) between
women who are not working outside the home vs. those who are working
(either part-time or full-time). A second dichotomy (<code>full</code>)
contrasts those who work full-time time vs. part-time, but among only
those who work.</p>
<p>The two binary variables for the nested dichotomies can be created by
recoding <code>partic</code> as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>Womenlf <span class="ot">&lt;-</span> <span class="fu">within</span>(Womenlf, {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  work <span class="ot">=</span> <span class="fu">ifelse</span>(partic <span class="sc">==</span> <span class="st">&quot;not.work&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  full <span class="ot">=</span> <span class="fu">ifelse</span>(partic <span class="sc">==</span> <span class="st">&quot;fulltime&quot;</span>,  <span class="dv">1</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                <span class="fu">ifelse</span>(partic <span class="sc">==</span> <span class="st">&quot;parttime&quot;</span>, <span class="dv">0</span>, <span class="cn">NA</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>})</span></code></pre></div>
<p>Note that the complete sample of 263 cases is available for the
<code>work</code> dichotomy, while only 108 cases—excluding those not
working outside the home—are available for the <code>full</code>
dichotomy:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> work, <span class="at">data=</span>Womenlf)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; work</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;   0   1 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 155 108</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> full, <span class="at">data=</span>Womenlf, <span class="at">addNA=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; full</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;    0    1 &lt;NA&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;   42   66  155</span></span></code></pre></div>
<p>The relationship of the response variable <code>partic</code> to the
two nested dichotomies is as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> partic <span class="sc">+</span> work, <span class="at">data=</span>Womenlf)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;           work</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; partic       0   1</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;   not.work 155   0</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;   parttime   0  42</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;   fulltime   0  66</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> partic <span class="sc">+</span> full, <span class="at">addNA=</span><span class="cn">TRUE</span>, <span class="at">data=</span>Womenlf)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;           full</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; partic       0   1 &lt;NA&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;   not.work   0   0  155</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;   parttime  42   0    0</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;   fulltime   0  66    0</span></span></code></pre></div>
<p>We can then fit separate binary logit models to the two nested
dichotomies directly:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>mod.work <span class="ot">&lt;-</span> <span class="fu">glm</span>(work <span class="sc">~</span> hincome <span class="sc">+</span> children, <span class="at">family=</span>binomial, <span class="at">data=</span>Womenlf)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>mod.full <span class="ot">&lt;-</span> <span class="fu">glm</span>(full <span class="sc">~</span> hincome <span class="sc">+</span> children, <span class="at">family=</span>binomial, <span class="at">data=</span>Womenlf)</span></code></pre></div>
<p>In equation form, the two log-odds models are shown below. (Model
equations are conveniently rendered in markdown/LaTeX using the
<code>equatiomatic</code> package <span class="citation">(Anderson,
Heiss, &amp; Sumners, 2023)</span>.)
<!-- equatiomatic::extract_eq(mod.work) -->
<!-- equatiomatic::extract_eq(mod.work) --></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>work</mo><mo>=</mo><mo>1</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>work</mo><mo>=</mo><mo>1</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>11</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>hincome</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>12</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>children</mo><mo>present</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
L_1 =\log\left[ \frac { P( \operatorname{work} = \operatorname{1} ) }{ 1 - P( \operatorname{work} = \operatorname{1} ) } \right] = \alpha_1 + \beta_{11}(\operatorname{hincome}) + \beta_{12}(\operatorname{children}_{\operatorname{present}})
</annotation></semantics></math>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>full</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>full</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>21</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>hincome</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>22</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>children</mo><mo>present</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
L_2 = \log\left[ \frac { P( \operatorname{full} ) }{ 1 - P( \operatorname{full} ) } \right] = \alpha_2 + \beta_{21}(\operatorname{hincome}) + \beta_{22}(\operatorname{children}_{\operatorname{present}})
</annotation></semantics></math> The estimated regression coefficients
for the two binary logit models are</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>mod.work</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = work ~ hincome + children, family = binomial, data = Womenlf)</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;          1.3358          -0.0423          -1.5756  </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 262 Total (i.e. Null);  260 Residual</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       356 </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 320   AIC: 326</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>mod.full</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = full ~ hincome + children, family = binomial, data = Womenlf)</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;           3.478           -0.107           -2.651  </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 107 Total (i.e. Null);  105 Residual</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;   (155 observations deleted due to missingness)</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       144 </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 104   AIC: 110</span></span></code></pre></div>
<p>A disadvantage of this approach is that it is tedious to obtain tests
for the combined model, to compute and plot predicted probabilities, and
so forth.</p>
</div>
<div id="using-dichotomy-and-logits-to-define-the-response"
class="section level3">
<h3>Using <code>dichotomy()</code> and <code>logits()</code> to define
the response</h3>
<p>Instead, the <strong>nestedLogit</strong> package provides tools to
specify and manipulate the nested-logit model. The
<code>dichotomy()</code> function defines a single dichotomy, and the
<code>logits()</code> function uses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
calls to <code>dichotomy()</code> to create a <code>"dichotomies"</code>
object representing the nested dichotomies. For example:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">logits</span>(<span class="at">work=</span><span class="fu">dichotomy</span>(<span class="st">&quot;not.work&quot;</span>, <span class="at">working=</span><span class="fu">c</span>(<span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>)),</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                      <span class="at">full=</span><span class="fu">dichotomy</span>(<span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>comparisons</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; work: {not.work} vs. working{parttime, fulltime}</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; full: {parttime} vs. {fulltime}</span></span></code></pre></div>
<p>It is mandatory to name the dichotomies (here <code>work</code> and
<code>full</code>), and we can optionally name the elements of each
dichotomy, an option that is particularly useful for a compound
category, such as <code>working=c("parttime", "fulltime")</code> in the
example.</p>
<p>There are coercion functions to convert the set of nested dichotomies
to a matrix or to a character string, representing the tree structure of
the dichotomies:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">as.matrix</span>(comparisons)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt;      not.work parttime fulltime</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; work        0        1        1</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; full       NA        0        1</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(comparisons))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; work = {{not.work}} {working{parttime fulltime}}; full = {{parttime}} {{fulltime}}</span></span></code></pre></div>
</div>
<div id="using-nestedlogit-to-fit-the-model" class="section level3">
<h3>Using <code>nestedLogit()</code> to fit the model</h3>
<p>To fit the model, we supply <code>comparisons</code> as the
<code>dichotomies</code> argument to the <code>nestedLogit()</code>
function. The model <code>formula</code> argument,
<code>partic ~ hincome + children</code> specifies a main-effects model
for husband’s income and presence of young children; aside from the
<code>dichotomies</code> argument, the general format of the function
call is typical for an R statistical modeling function (with optional
<code>subset</code> and <code>contrasts</code> arguments not shown in
this example). An atypical feature of <code>nestedLogit()</code> is that
the <code>data</code> argument is required.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>wlf.nested <span class="ot">&lt;-</span> <span class="fu">nestedLogit</span>(partic <span class="sc">~</span> hincome <span class="sc">+</span> children, </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                          <span class="at">dichotomies =</span> comparisons,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                          <span class="at">data=</span>Womenlf)</span></code></pre></div>
<p>The result, <code>wlf.nested</code>, is a an object of class
<code>"nestedLogit"</code>, encapsulating the details of the model for
the nested dichotomies. The <code>models</code> component of the object
contains essentially the same <code>"glm"</code> model objects as we
constructed directly as <code>mod.work</code> and <code>mod.full</code>
above, here named <code>work</code> and <code>full</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">names</span>(wlf.nested)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;models&quot;          &quot;formula&quot;         &quot;dichotomies&quot;     &quot;data&quot;           </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [5] &quot;data.name&quot;       &quot;subset&quot;          &quot;contrasts&quot;       &quot;contrasts.print&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">names</span>(wlf.nested<span class="sc">$</span>models) <span class="co"># equivalent: names(models(wlf.models))</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;work&quot; &quot;full&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># view the separate models</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">models</span>(wlf.nested, <span class="dv">1</span>) </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = work ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;          1.3358          -0.0423          -1.5756  </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 262 Total (i.e. Null);  260 Residual</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       356 </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 320   AIC: 326</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="fu">models</span>(wlf.nested, <span class="dv">2</span>)</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = full ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt;           3.478           -0.107           -2.651  </span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 107 Total (i.e. Null);  105 Residual</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt;   (155 observations deleted due to missingness)</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       144 </span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 104   AIC: 110</span></span></code></pre></div>
</div>
<div id="methods-for-nestedlogit-objects" class="section level3">
<h3>Methods for <code>"nestedLogit"</code> objects</h3>
<p>As befits a model-fitting function, the package defines a nearly
complete set of methods for <code>"nestedLogit"</code> objects:</p>
<ul>
<li><code>print()</code> and <code>summary()</code> print the results
for each of the submodels.</li>
<li><code>update()</code> re-fits the model, allowing changes to the
model <code>formula</code>, <code>data</code>, <code>subset</code>, and
<code>contrasts</code> arguments.</li>
<li><code>coef()</code> returns the coefficients for the predictors in
each dichotomy.</li>
<li><code>vcov()</code> returns the variance-covariance matrix of the
coefficients</li>
<li><code>predict()</code> computes predicted probabilities for the
response categories, either for the cases in the data, which is
equivalent to <code>fitted()</code>, or for arbitrary combinations of
the predictors; the latter is useful for producing plots to aid
interpretation.</li>
<li><code>confint()</code> calculates confidence intervals for the
predicted probabilities or predicted logits.</li>
<li><code>as.data.frame()</code> method for predicted probabilities and
logits converts these to long format for use with
<code>ggplot2</code>.</li>
<li><code>glance()</code> and <code>tidy()</code> are extensions of
<code>broom::glance.glm()</code> and <code>broom::tidy.glm()</code> to
obtain compact summaries of a <code>"nestedLogit"</code> model
object.</li>
<li><code>plot()</code> provides basic plots of the predicted
probabilities over a range of values of the predictor variables.</li>
<li><code>models()</code> is an extractor function for the binary logit
models in the <code>"nestedLogit"</code> object</li>
<li><code>Effect()</code> calculates marginal effects collapsed over
some variable(s) for the purpose of making effect plots.</li>
</ul>
<p>These functions are supplemented by various methods for testing
hypotheses about and comparing nested-logit models:</p>
<ul>
<li><code>anova()</code> provides analysis-of-deviance Type I
(sequential) tests for each dichotomy and for the combined model. When
given a sequence of model objects, <code>anova()</code> tests the models
against one another in the order specified.</li>
<li><code>Anova()</code> uses <code>car::Anova()</code> to provide
analysis-of-deviance Type II or III (partial) tests for each dichotomy
and for the combined model.</li>
<li><code>linearHypothesis()</code> uses
<code>car::linearHypothesis()</code> to compute Wald tests for
hypotheses about coefficients or their linear combinations.</li>
<li><code>logLik()</code> returns the log-likelihood and degrees of
freedom for the nested-dichotomies logit model.</li>
<li>Through <code>logLik()</code>, the <code>AIC()</code> and
<code>BIC()</code> functions compute the Akaike and Bayesian information
criteria model-comparison statistics.</li>
</ul>
<p>We illustrate the application of some of these methods:</p>
<p><strong>Coefficients</strong>: By default, <code>coef()</code>
returns a matrix whose rows are the regressors in the model and whose
columns represent the nested dichotomies. In the <code>Womenlf</code>
example, the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mrow><mi>j</mi><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\widehat{\beta}_{j1}</annotation></semantics></math>
give the estimated change in the log-odds of working vs. not working
associated with a $1,000 increase in husband’s income and with having
children present vs. absent, each holding the other constant. The
coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mrow><mi>j</mi><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">\widehat{\beta}_{j2}</annotation></semantics></math>
are similar for the log-odds of working full-time vs. part-time among
those who are working outside the home. The exponentiated coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mrow><mi>j</mi><mi>k</mi></mrow></msub></msup><annotation encoding="application/x-tex">e^{\widehat{\beta}_{jk}}</annotation></semantics></math>
give multiplicative effects on the odds for these comparisons.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">coef</span>(wlf.nested)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt;                     work    full</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; (Intercept)      1.33583  3.4778</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; hincome         -0.04231 -0.1073</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; childrenpresent -1.57565 -2.6515</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># show as odds ratios</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(wlf.nested))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt;                   work     full</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)     3.8032 32.38753</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; hincome         0.9586  0.89829</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; childrenpresent 0.2069  0.07055</span></span></code></pre></div>
<p>Thus, the odds of both working and working full-time decrease with
husband’s income, by about 4% and 10% respectively per $1000. Having
young children also decreases the odds of both working and working
full-time, by about 79% and 93% respectively.</p>
<p><strong>Analysis of deviance</strong>: A method for the
<code>Anova()</code> function from the <strong>car</strong> package
<span class="citation">(Fox, Weisberg, &amp; Price, 2023)</span>
computes Type II or III likelihood-ratio or Wald tests for each term in
the model. Note that the likelihood-ratio or Wald
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
and degrees of freedom for the <code>Combined Responses</code> is the
sum of their values for the separate dichotomies:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">Anova</span>(wlf.nested)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; hincome      4.83  1      0.028 *  </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; children    31.32  1    2.2e-08 ***</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; hincome       9.0  1     0.0027 ** </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; children     32.1  1    1.4e-08 ***</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Combined Responses</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; hincome      13.8  2      0.001 ** </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; children     63.5  2    1.7e-14 ***</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Linear hypotheses</strong>: The
<code>linearHypothesis()</code> function in the <strong>car</strong>
package provides a very general method for computing Wald tests of
specific hypotheses about individual coefficients in a model or their
linear combinations.</p>
<p>For example, the following command tests the hypothesis that the
coefficients for <code>hincome</code> and <code>children</code> are
simultaneously all equal to zero. This is equivalent to the test of the
global null model,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>:
all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{jk} = 0</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>;</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">j = 1,2; k=1,2</annotation></semantics></math>
against an alternative that one or more coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{jk} \ne 0</annotation></semantics></math>.</p>
<p><code>linearHypothesis()</code> reports this test for each of the
submodels for the dichotomies <code>work</code> and <code>full</code>,
as well as for the combined model:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">linearHypothesis</span>(wlf.nested, <span class="fu">c</span>(<span class="st">&quot;hincome&quot;</span>, <span class="st">&quot;childrenpresent&quot;</span>))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test: </span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; hincome = 0 </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; childrenpresent = 0 </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Model 2: partic ~ hincome + children </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime} </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; 1    262                        </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; 2    260  2  32.2      1e-07 ***</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 1    107                        </span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 2    105  2  25.6    2.8e-06 ***</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; Combined Responses</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; Chisq = 57.813, Df = 4, Pr(&gt;Chisq) = 8.4e-12</span></span></code></pre></div>
<p><strong>Tidy summaries</strong>: The <strong>broom</strong> package
<span class="citation">(Robinson, Hayes, &amp; Couch, 2023)</span>
provides functions for compact and tidy summaries of fitted models. The
<code>glance()</code> method for a <code>"nestedLogit"</code> model
produces a one-line summary of the statistics for each dichotomy. The
<code>tidy()</code> method combines the coefficients for the sub-models,
together with test statistics:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">glance</span>(wlf.nested)   <span class="co"># summarize the sub-models</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; [38;5;246m# A tibble: 2 × 9[39m</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;   response null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;   [3m[38;5;246m&lt;chr&gt;[39m[23m            [3m[38;5;246m&lt;dbl&gt;[39m[23m   [3m[38;5;246m&lt;int&gt;[39m[23m  [3m[38;5;246m&lt;dbl&gt;[39m[23m [3m[38;5;246m&lt;dbl&gt;[39m[23m [3m[38;5;246m&lt;dbl&gt;[39m[23m    [3m[38;5;246m&lt;dbl&gt;[39m[23m       [3m[38;5;246m&lt;int&gt;[39m[23m [3m[38;5;246m&lt;int&gt;[39m[23m</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; [38;5;250m1[39m work              356.     262 -[31m160[39m[31m.[39m   326.  336.     320.         260   263</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; [38;5;250m2[39m full              144.     107  -[31m52[39m[31m.[39m[31m2[39m  110.  119.     104.         105   108</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="fu">tidy</span>(wlf.nested)     <span class="co"># summarize the coefficients</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; [38;5;246m# A tibble: 6 × 6[39m</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;   response term            estimate std.error statistic      p.value</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;   [3m[38;5;246m&lt;chr&gt;[39m[23m    [3m[38;5;246m&lt;chr&gt;[39m[23m              [3m[38;5;246m&lt;dbl&gt;[39m[23m     [3m[38;5;246m&lt;dbl&gt;[39m[23m     [3m[38;5;246m&lt;dbl&gt;[39m[23m        [3m[38;5;246m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; [38;5;250m1[39m work     (Intercept)       1.34      0.384       3.48 0.000[4m5[24m[4m0[24m[4m0[24m    </span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; [38;5;250m2[39m work     hincome          -[31m0[39m[31m.[39m[31m0[39m[31m42[4m3[24m[39m    0.019[4m8[24m     -[31m2[39m[31m.[39m[31m14[39m 0.032[4m4[24m      </span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; [38;5;250m3[39m work     childrenpresent  -[31m1[39m[31m.[39m[31m58[39m      0.292      -[31m5[39m[31m.[39m[31m39[39m 0.000[4m0[24m[4m0[24m[4m0[24m070[4m0[24m</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; [38;5;250m4[39m full     (Intercept)       3.48      0.767       4.53 0.000[4m0[24m[4m0[24m[4m5[24m80  </span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; [38;5;250m5[39m full     hincome          -[31m0[39m[31m.[39m[31m107[39m     0.039[4m2[24m     -[31m2[39m[31m.[39m[31m74[39m 0.006[4m1[24m[4m5[24m     </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; [38;5;250m6[39m full     childrenpresent  -[31m2[39m[31m.[39m[31m65[39m      0.541      -[31m4[39m[31m.[39m[31m90[39m 0.000[4m0[24m[4m0[24m[4m0[24m957</span></span></code></pre></div>
<p>These functions facilitate the construction of custom tables. For
example, to extract the likelihood-ratio difference-in-deviance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>)
tests and compute
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mn>2</mn></msup><mi>/</mi><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">G^2 / df</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>gl <span class="ot">&lt;-</span> <span class="fu">glance</span>(wlf.nested)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>gl <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">select</span>(response, deviance, df.residual) <span class="sc">|&gt;</span> </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">response =</span> <span class="st">&quot;Combined&quot;</span>, <span class="at">deviance =</span> <span class="fu">sum</span>(gl<span class="sc">$</span>deviance), <span class="at">df.residual =</span> <span class="fu">sum</span>(gl<span class="sc">$</span>df.residual)) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">pchisq</span>(deviance, df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    <span class="st">`</span><span class="at">$G^2$/df</span><span class="st">`</span> <span class="ot">=</span> deviance <span class="sc">/</span> df.residual) <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">$G^2$</span><span class="st">`</span> <span class="ot">=</span> deviance,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>         <span class="at">df =</span> df.residual) <span class="sc">|&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">response</th>
<th
align="right"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math></th>
<th align="right">df</th>
<th align="right">P-value</th>
<th
align="right"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>/df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">work</td>
<td align="right">319.7</td>
<td align="right">260</td>
<td align="right">0.007</td>
<td align="right">1.230</td>
</tr>
<tr class="even">
<td align="left">full</td>
<td align="right">104.5</td>
<td align="right">105</td>
<td align="right">0.496</td>
<td align="right">0.995</td>
</tr>
<tr class="odd">
<td align="left">Combined</td>
<td align="right">424.2</td>
<td align="right">365</td>
<td align="right">0.018</td>
<td align="right">1.162</td>
</tr>
</tbody>
</table>
<p><strong>Model updating</strong>: The <code>update()</code> function
makes it easy to create a new model from an old one, by adding or
subtracting terms from the model formula, specifying a new formula, or
changing the observations used or contrasts for factors.</p>
<p>For example, you might ask, “<em>Does it make sense to include region
of Canada in the model for the <code>Womenlf</code> data?</em>” This
question can be answered by adding <code>region</code> to the model
formula, and comparing the new model to the original one using
<code>anova()</code>. The tests here are for the additional contribution
of <code>region</code> over and above the main effects of
<code>hincome</code> and <code>children</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>wlf.nested<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(wlf.nested, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">+</span> region)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">anova</span>(wlf.nested, wlf.nested<span class="fl">.1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;  Model 2: partic ~ hincome + children + region </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; 1       260        320                     </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; 2       256        317  4     2.43     0.66</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 1       105        104                     </span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; 2       101        102  4     2.65     0.62</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; Combined Responses</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 1       365        424                     </span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 2       357        419  8     5.08     0.75</span></span></code></pre></div>
<p>Recall that <code>anova()</code> with two or models tests the models
sequentially against one another, in the order specified. This assumes
that the models compared are <em>nested</em> (an unintentional pun), in
the sense that the terms in the smaller model in each sequential pair
are a subset of those in the larger model.</p>
<p>In a similar manner, we could fit and test a <em>wider</em> scope of
models. For example to add an interaction between husband’s income and
children and then test the interaction term:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>wlf.nested<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(wlf.nested, <span class="at">formula =</span> . <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">anova</span>(wlf.nested, wlf.nested<span class="fl">.2</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt;  Model 2: partic ~ hincome + children + hincome:children </span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; 1       260        320                     </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; 2       259        319  1    0.608     0.44</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; 1       105        104                     </span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; 2       104        104  1    0.256     0.61</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; Combined Responses</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt; 1       365        424                     </span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt; 2       363        423  2    0.864     0.65</span></span></code></pre></div>
<p>We can see that neither <code>region</code> nor the
<code>hincome</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
<code>children</code> interaction make a difference to the fit either of
the sub-models or of the combined model for the three response
categories.</p>
</div>
<div id="obtaining-fitted-values-predict" class="section level3">
<h3>Obtaining fitted values: <code>predict()</code></h3>
<p>By default, <code>predict()</code> for a <code>"nestedLogit"</code>
model object returns a <code>"predictNestedLogit"</code> object, which
is a named list of four data frames whose columns are the response
categories:</p>
<ul>
<li><code>p</code>: predicted response-category probabilities.</li>
<li><code>logit</code>: the predicted probabilities transformed to the
log-odds (logit) scale, <code>logit = log(p / (1 - p))</code>.</li>
<li><code>se.p</code>: standard errors of the predicted probabilities,
computed by the delta method (see the corresponding vignette).</li>
<li><code>se.logit</code>: standard errors of the logits.</li>
</ul>
<p>The computation is a bit tricky, because the probabilities of working
full-time or part-time are conditional on working outside the home, but
<code>predict()</code> takes care of the details. See
<code>vignette("standard-errors")</code> for how these are
calculated.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>wlf.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">print</span>(wlf.pred, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; First 5 of 263 rows:</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; predicted response-category probabilties</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt;   not.work parttime fulltime</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; 1   0.7057   0.2020 0.092343</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; 2   0.6878   0.1993 0.112912</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; 3   0.8951   0.1030 0.001886</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; 4   0.7708   0.1920 0.037208</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; 5   0.7396   0.2007 0.059742</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt;   . . .</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; predicted response-category logits</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt;   not.work parttime fulltime</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; 1   0.8744   -1.374   -2.285</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; 2   0.7898   -1.391   -2.061</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; 3   2.1437   -2.164   -6.272</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; 4   1.2129   -1.437   -3.253</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; 5   1.0437   -1.382   -2.756</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt;   . . .</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt; standard errors of predicted probabilities</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#&gt;   not.work parttime fulltime</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; 1  0.03394  0.03077 0.022756</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; 2  0.03514  0.03104 0.024934</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; 3  0.05948  0.05846 0.002676</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt; 4  0.04243  0.03908 0.017651</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; 5  0.03651  0.03368 0.020323</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt;   . . .</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; standard errors of predicted logits</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt;   not.work parttime fulltime</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="co">#&gt; 1   0.1634   0.1909   0.2715</span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; 2   0.1637   0.1945   0.2489</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; 3   0.6333   0.6326   1.4215</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; 4   0.2402   0.2519   0.4927</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; 5   0.1896   0.2100   0.3618</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt;   . . .</span></span></code></pre></div>
<p>By default, fitted values and standard errors are computed for
<em>all</em> the observations in the data set. You can provide a
<code>newdata</code> data.frame containing arbitrary combinations of
predicted values, for example to obtain a grid of predicted values for
custom plots or other purposes.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">hincome=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="at">length=</span><span class="dv">4</span>),</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                   <span class="at">children=</span><span class="fu">c</span>(<span class="st">&quot;absent&quot;</span>, <span class="st">&quot;present&quot;</span>))</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>wlf.new <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested, new)</span></code></pre></div>
<p>For greater flexibility, the <code>as.data.frame()</code> method for
<code>"predictNestedLogit"</code> converts the components to long
format.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">as.data.frame</span>(wlf.new) </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#&gt;    hincome children response        p     se.p    logit se.logit</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; 1        0   absent not.work 0.208197 0.063264 -1.33583   0.3838</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt; 2        0   absent parttime 0.023716 0.017749 -3.71762   0.7666</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt; 3        0   absent fulltime 0.768088 0.063856  1.19755   0.3585</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; 4       15   absent not.work 0.331545 0.053684 -0.70120   0.2422</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt; 5       15   absent parttime 0.089363 0.033557 -2.32144   0.4124</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt; 6       15   absent fulltime 0.579092 0.056899  0.31905   0.2334</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; 7       30   absent not.work 0.483362 0.095465 -0.06658   0.3823</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; 8       30   absent parttime 0.224959 0.095639 -1.23700   0.5485</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt; 9       30   absent fulltime 0.291679 0.101606 -0.88724   0.4918</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; 10      45   absent not.work 0.638313 0.147769  0.56805   0.6401</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; 11      45   absent parttime 0.287184 0.137011 -0.90910   0.6693</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; 12      45   absent fulltime 0.074503 0.077020 -2.51949   1.1170</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; 13       0  present not.work 0.559669 0.079322  0.23982   0.3219</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; 14       0  present parttime 0.134047 0.057151 -1.86564   0.4923</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt; 15       0  present fulltime 0.306284 0.075679 -0.81755   0.3562</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt; 16      15  present not.work 0.705670 0.033942  0.87445   0.1634</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; 17      15  present parttime 0.201988 0.030774 -1.37392   0.1909</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt; 18      15  present fulltime 0.092343 0.022756 -2.28536   0.2715</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt; 19      30  present not.work 0.818924 0.052611  1.50907   0.3548</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; 20      30  present parttime 0.165901 0.049356 -1.61496   0.3567</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; 21      30  present fulltime 0.015175 0.011492 -4.17279   0.7689</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt; 22      45  present not.work 0.895078 0.059478  2.14370   0.6333</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt; 23      45  present parttime 0.103036 0.058460 -2.16394   0.6326</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt; 24      45  present fulltime 0.001886 0.002676 -6.27153   1.4215</span></span></code></pre></div>
</div>
<div id="plotting-nestedlogit-objects" class="section level3">
<h3>Plotting <code>"nestedLogit"</code> objects</h3>
<p>The <strong>nestedLogit</strong> package includes a basic
<code>plot()</code> method for <code>"nestedLogit"</code> models, which
calculates fitted probabilities and standard errors for the response
categories and plots the probabilities and point-wise confidence limits
against a single explanatory variable on the horizontal axis, while
<code>other</code> explanatory variables are fixed to particular values.
To produce multi-panel plots, it is necessary to call
<code>plot()</code> repeatedly for various levels of the other
predictors, and to compose these into a single figure, for example using
<code>par("mfcol")</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>col <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="dv">3</span>)                  <span class="co"># ggplot discrete colors</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">plot</span>(wlf.nested, <span class="st">&quot;hincome&quot;</span>,                  <span class="co"># left panel</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>     <span class="at">other =</span> <span class="fu">list</span>(<span class="at">children=</span><span class="st">&quot;absent&quot;</span>),</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Husband&#39;s Income&quot;</span>, </span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>     <span class="at">legend.location=</span><span class="st">&quot;top&quot;</span>, <span class="at">col =</span> col)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">plot</span>(wlf.nested, <span class="st">&quot;hincome&quot;</span>,                  <span class="co"># right panel</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>     <span class="at">other =</span> <span class="fu">list</span>(<span class="at">children=</span><span class="st">&quot;present&quot;</span>),</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Husband&#39;s Income&quot;</span>, </span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>     <span class="at">legend=</span><span class="cn">FALSE</span>, <span class="at">col =</span> col)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="fu">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-plot-1.png" class="r-plt" alt="**plot method**: Predicted probabilities and 95 percent pointwise confidence envelopes of not working, working part-time, and working full-time" width="100%" />
<p class="caption">
<strong>plot method</strong>: Predicted probabilities and 95 percent
pointwise confidence envelopes of not working, working part-time, and
working full-time
</p>
</div>
</div>
<div id="effect-plots-for-nestedlogit-models" class="section level3">
<h3>Effect plots for <code>"nestedLogit"</code> models</h3>
<p>We provide a <code>"nestedLogit"</code> method for the
<code>Effect()</code> function in the <strong>effects</strong> package
<span class="citation">(Fox, 2003; Fox &amp; Weisberg, 2019)</span>.
Because <code>Effect()</code> is the basic building block for other
functions in the <strong>effects</strong> package, such as
<code>predictorEffects()</code> <span class="citation">(Fox &amp;
Weisberg, 2018)</span>, the full range of capabilities of the
<strong>effects</strong> package is available; in particular, it’s
possible to produce effect plots similar to those for multinomial
logistic regression models <span class="citation">(Fox &amp; Hong,
2009)</span>.</p>
<p>We illustrate with the nested-logit model fit to the
<code>Womenlf</code> data set:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(wlf.nested))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-effect-plot-1-1.png" class="r-plt" alt="Default predictor effect plots for the nested-logit model fit to the `Womenlf` data" width="100%" />
<p class="caption">
Default predictor effect plots for the nested-logit model fit to the
<code>Womenlf</code> data
</p>
</div>
<p>The panel at the left shows the predictor effect plot for husband’s
income, that at the right the predictor effect plot for presence of
children.</p>
<p>Because the model is additive, there are no conditioning variables in
either plot. Effect plots are generally more interesting in models with
interactions, in which case the effect plot for a predictor is
conditioned on the other predictors with which the focal predictor
interacts (see <code>?Effect.nestedLogit</code> for an example).</p>
<p>In the predictor effect plot for <code>hincome</code>, the factor
<code>children</code> is by default fixed to its distribution in the
data; in the predictor effect plot for <code>children</code>, the
numeric predictor <code>hincome</code> is by default fixed to its mean.
The band in the graph at the left and vertical bars in the graph at the
right give 95% confidence limits around the fit.</p>
<p>An alternative style of effect plot shows the fit as a stacked-area
graph (in this case without confidence limits):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffects</span>(wlf.nested),</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>     <span class="at">axes=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">style=</span><span class="st">&quot;stacked&quot;</span>)),</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>     <span class="at">lines=</span><span class="fu">list</span>(<span class="at">col=</span>scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="dv">3</span>)))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-effect-plot-2-1.png" class="r-plt" alt="Stacked-area predictor effect plots for the nested-logit model fit to the `Womenlf` data" width="100%" />
<p class="caption">
Stacked-area predictor effect plots for the nested-logit model fit to
the <code>Womenlf</code> data
</p>
</div>
<p>The computation and display of effect graphs are highly customizable.
For details, see the documentation for the <strong>effects</strong>
package.</p>
<p>Effect plots for nestedLogit models are also supported in the
<strong>ggeffects</strong> package <span class="citation">(Lüdecke,
2023)</span>. For example, the following (not run) produces plots of
predicted probabilities for the same model with separate panels for the
levels of <code>partic</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggpredict</span>(wlf.nested, <span class="fu">c</span>(<span class="st">&quot;hincome[all]&quot;</span>, <span class="st">&quot;children&quot;</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code></pre></div>
</div>
<div id="alternative-models-for-the-womenlf-data"
class="section level3">
<h3>Alternative models for the <code>Womenlf</code> data</h3>
<p>We’ve mentioned that the nested dichotomies {not working}
vs. {part-time, full-time} and {part-time} vs. {full-time} for the
<code>Womenlf</code> data are largely arbitrary. An alternative set of
nested dichotomies first contrasts full-time work with the other
categories, {full-time} vs. {not working, part-time}, and then {not
working} vs. {part-time}. The rationale is that the real hurdle for
young married women to enter the paid labor force is to combine
full-time work outside the home with housework. This alternative
nested-dichotomies model proves enlightening:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>wlf.nested.alt <span class="ot">&lt;-</span> <span class="fu">nestedLogit</span>(partic <span class="sc">~</span> hincome <span class="sc">+</span> children,</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>                              <span class="fu">logits</span>(<span class="at">full=</span><span class="fu">dichotomy</span>(<span class="at">nonfulltime=</span><span class="fu">c</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>), <span class="st">&quot;fulltime&quot;</span>),</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                                     <span class="at">part=</span><span class="fu">dichotomy</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>)),</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                              <span class="at">data=</span>Womenlf)</span></code></pre></div>
<p>The <code>Anova()</code> and <code>summary()</code> for this model
show that the effects of husband’s income and children make a
substantial contribution to the <code>full</code> model but not to the
<code>part</code> model:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">Anova</span>(wlf.nested.alt)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt; Response full: nonfulltime{not.work, parttime} vs. {fulltime}</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; hincome      15.1  1      1e-04 ***</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; children     63.6  1    1.6e-15 ***</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; Response part: {not.work} vs. {parttime}</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co">#&gt; hincome    0.0851  1       0.77</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt; children   0.0012  1       0.97</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">#&gt; Combined Responses</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt; hincome      15.2  2    0.00051 ***</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; children     63.6  2    1.6e-14 ***</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="fu">summary</span>(wlf.nested.alt)</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="co">#&gt; Nested logit models: partic ~ hincome + children</span></span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a><span class="co">#&gt; Response full: nonfulltime{not.work, parttime} vs. {fulltime}</span></span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a><span class="co">#&gt; glm(formula = full ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1.7696     0.4690    3.77  0.00016 ***</span></span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a><span class="co">#&gt; hincome          -0.0987     0.0277   -3.57  0.00036 ***</span></span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a><span class="co">#&gt; childrenpresent  -2.5631     0.3489   -7.35    2e-13 ***</span></span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-41"><a href="#cb28-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-42"><a href="#cb28-42" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb28-43"><a href="#cb28-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-44"><a href="#cb28-44" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 296.34  on 262  degrees of freedom</span></span>
<span id="cb28-45"><a href="#cb28-45" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 218.81  on 260  degrees of freedom</span></span>
<span id="cb28-46"><a href="#cb28-46" tabindex="-1"></a><span class="co">#&gt; AIC: 224.8</span></span>
<span id="cb28-47"><a href="#cb28-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-48"><a href="#cb28-48" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span>
<span id="cb28-49"><a href="#cb28-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-50"><a href="#cb28-50" tabindex="-1"></a><span class="co">#&gt; Response part: {not.work} vs. {parttime}</span></span>
<span id="cb28-51"><a href="#cb28-51" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-52"><a href="#cb28-52" tabindex="-1"></a><span class="co">#&gt; glm(formula = part ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span id="cb28-53"><a href="#cb28-53" tabindex="-1"></a><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span id="cb28-54"><a href="#cb28-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-55"><a href="#cb28-55" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-56"><a href="#cb28-56" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb28-57"><a href="#cb28-57" tabindex="-1"></a><span class="co">#&gt; (Intercept)     -1.42758    0.58222   -2.45    0.014 *</span></span>
<span id="cb28-58"><a href="#cb28-58" tabindex="-1"></a><span class="co">#&gt; hincome          0.00687    0.02343    0.29    0.769  </span></span>
<span id="cb28-59"><a href="#cb28-59" tabindex="-1"></a><span class="co">#&gt; childrenpresent  0.01629    0.46762    0.03    0.972  </span></span>
<span id="cb28-60"><a href="#cb28-60" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-61"><a href="#cb28-61" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-62"><a href="#cb28-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-63"><a href="#cb28-63" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb28-64"><a href="#cb28-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-65"><a href="#cb28-65" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 204.16  on 196  degrees of freedom</span></span>
<span id="cb28-66"><a href="#cb28-66" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 204.07  on 194  degrees of freedom</span></span>
<span id="cb28-67"><a href="#cb28-67" tabindex="-1"></a><span class="co">#&gt;   (66 observations deleted due to missingness)</span></span>
<span id="cb28-68"><a href="#cb28-68" tabindex="-1"></a><span class="co">#&gt; AIC: 210.1</span></span>
<span id="cb28-69"><a href="#cb28-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-70"><a href="#cb28-70" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>It’s apparent that the alternative model produces a simpler
description of the data: The predictors husband’s income and presence of
children affect the decision to work full-time, but not the decision to
work part-time among those who aren’t engaged in full-time work.</p>
<p>But do the fits of the two models to the data differ? We can compare
fitted probabilities under the two specifications:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested)<span class="sc">$</span>p</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested.alt)<span class="sc">$</span>p</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">cor</span>(fit1, fit2))</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt; not.work parttime fulltime </span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co">#&gt;   0.9801   0.9185   0.9961</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.matrix</span>(<span class="fu">abs</span>(fit1 <span class="sc">-</span> fit2)))</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt; [1] 0.01712</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(fit1 <span class="sc">-</span> fit2))</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.1484</span></span></code></pre></div>
<p>The fitted probabilities are similar but far from the same.</p>
<p>The two models have the same number of parameters and neither is
nested within the other, so a conventional likelihood-ratio test is
inappropriate, but we can still compare maximized log-likelihoods under
the two models:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">logLik</span>(wlf.nested)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -212.1 (df=6)</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">logLik</span>(wlf.nested.alt)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -211.4 (df=6)</span></span></code></pre></div>
<p>Because the sample sizes and numbers of parameters are the same for
the two models, differences in AIC and BIC are just twice the
differences in the log-likelihoods; for example:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">AIC</span>(wlf.nested, wlf.nested.alt)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co">#&gt;                df   AIC</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#&gt; wlf.nested      6 436.2</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#&gt; wlf.nested.alt  6 434.9</span></span></code></pre></div>
<p>The comparison slightly favors the alternative nested-dichotomies
model.</p>
<p>Here’s a graph of the alternative model:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>col <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="dv">3</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">plot</span>(wlf.nested.alt, <span class="st">&quot;hincome&quot;</span>,           <span class="co"># left panel</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>     <span class="at">others =</span> <span class="fu">list</span>(<span class="at">children=</span><span class="st">&quot;absent&quot;</span>), </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>     <span class="at">legend.location=</span><span class="st">&quot;top&quot;</span>, <span class="at">col =</span> col)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="fu">plot</span>(wlf.nested.alt, <span class="st">&quot;hincome&quot;</span>,           <span class="co"># right panel</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>     <span class="at">others =</span> <span class="fu">list</span>(<span class="at">children=</span><span class="st">&quot;present&quot;</span>),</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, </span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>     <span class="at">legend=</span><span class="cn">FALSE</span>, <span class="at">col =</span> col)</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-alt-plot-1.png" class="r-plt" alt="Predicted probabilities for the alternative nested-dichotomies model" width="100%" />
<p class="caption">
Predicted probabilities for the alternative nested-dichotomies model
</p>
</div>
<p>Compare this to the previous graph for the original
specification.</p>
<p>It’s also of interest to compare the nested-dichotomies models to the
multinomial logit model, which, as we explained, treats the response
categories symmetrically:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>wlf.multinom <span class="ot">&lt;-</span> <span class="fu">multinom</span>(partic <span class="sc">~</span> hincome <span class="sc">+</span> children, <span class="at">data =</span> Womenlf)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co">#&gt; # weights:  12 (6 variable)</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">#&gt; initial  value 288.935032 </span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#&gt; iter  10 value 211.454772</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co">#&gt; final  value 211.440963 </span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="fu">summary</span>(wlf.multinom)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="co">#&gt; multinom(formula = partic ~ hincome + children, data = Womenlf)</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="co">#&gt;          (Intercept)   hincome childrenpresent</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="co">#&gt; parttime      -1.432  0.006894         0.02146</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#&gt; fulltime       1.983 -0.097232        -2.55861</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co">#&gt; Std. Errors:</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="co">#&gt;          (Intercept) hincome childrenpresent</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="co">#&gt; parttime      0.5925 0.02345          0.4690</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="co">#&gt; fulltime      0.4842 0.02810          0.3622</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 422.9 </span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a><span class="co">#&gt; AIC: 434.9</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a><span class="fu">logLik</span>(wlf.multinom)</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -211.4 (df=6)</span></span></code></pre></div>
<p>Check the relationship between fitted probabilities:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.multinom, <span class="at">type=</span><span class="st">&quot;probs&quot;</span>)[, <span class="fu">c</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>)]</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">cor</span>(fit2, fit3))</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#&gt; not.work parttime fulltime </span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#&gt;        1        1        1</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.matrix</span>(<span class="fu">abs</span>(fit2 <span class="sc">-</span> fit3)))</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001251</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(fit2 <span class="sc">-</span> fit3))</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co">#&gt; [1] 0.0006908</span></span></code></pre></div>
<p>As it turns out, the multinomial logit model and the alternative
nested-dichotomies model produce nearly identical fits with similar
simple interpretations.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0" line-spacing="2">
<div id="ref-R-equatiomatic" class="csl-entry">
Anderson, D., Heiss, A., &amp; Sumners, J. (2023). <em>Equatiomatic:
Transform models into LaTeX equations</em>.
</div>
<div id="ref-Atkinson-etal:1984" class="csl-entry">
Atkinson, T., Blishen, B. R., Ornstein, M. D., &amp; Stevenson, H. M.
(1984). <span class="nocase">Quality of Canadian Life: Social Change in
Canada</span>, 1977. ICPSR - Interuniversity Consortium for Political;
Social Research. http://doi.org/<a
href="https://doi.org/10.3886/ICPSR07879.V1">10.3886/ICPSR07879.V1</a>
</div>
<div id="ref-Fienberg:80" class="csl-entry">
Fienberg, S. E. (1980). <em>The analysis of cross-classified categorical
data</em> (Second edition). Cambridge, MA: MIT Press.
</div>
<div id="ref-Fox:1984:LSM" class="csl-entry">
Fox, J. (1984). <em>Linear statistical models and related methods</em>.
New York: Wiley.
</div>
<div id="ref-effects2003" class="csl-entry">
Fox, J. (2003). Effect displays in <span>R</span> for generalised linear
models. <em>Journal of Statistical Software</em>, <em>8</em>(15), 1–27.
http://doi.org/<a
href="https://doi.org/10.18637/jss.v008.i15">10.18637/jss.v008.i15</a>
</div>
<div id="ref-Fox:2016:ARA" class="csl-entry">
Fox, J. (2016). <em>Applied regression analysis and generalized linear
models</em> (Third edition). Thousand Oaks <span>CA</span>: SAGE.
Retrieved from <a
href="https://www.john-fox.ca/AppliedRegression/index.html">https://www.john-fox.ca/AppliedRegression/index.html</a>
</div>
<div id="ref-effects2009" class="csl-entry">
Fox, J., &amp; Hong, J. (2009). Effect displays in <span>R</span> for
multinomial and proportional-odds logit models: Extensions to the <span
class="nocase">effects</span> package. <em>Journal of Statistical
Software</em>, <em>32</em>(1), 1–24. http://doi.org/<a
href="https://doi.org/10.18637/jss.v032.i01">10.18637/jss.v032.i01</a>
</div>
<div id="ref-effects2018" class="csl-entry">
Fox, J., &amp; Weisberg, S. (2018). Visualizing fit and lack of fit in
complex regression models with predictor effect plots and partial
residuals. <em>Journal of Statistical Software</em>, <em>87</em>(9),
1–27. http://doi.org/<a
href="https://doi.org/10.18637/jss.v087.i09">10.18637/jss.v087.i09</a>
</div>
<div id="ref-FoxWeisberg:2019:CAR" class="csl-entry">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to
applied regression</em> (Third edition). Thousand Oaks <span>CA</span>:
Sage. Retrieved from <a
href="https://www.john-fox.ca/Companion/index.html">https://www.john-fox.ca/Companion/index.html</a>
</div>
<div id="ref-R-carData" class="csl-entry">
Fox, J., Weisberg, S., &amp; Price, B. (2022). <em>carData: Companion to
applied regression data sets</em>. Retrieved from <a
href="https://CRAN.R-project.org/package=carData">https://CRAN.R-project.org/package=carData</a>
</div>
<div id="ref-R-car" class="csl-entry">
Fox, J., Weisberg, S., &amp; Price, B. (2023). <em>Car: Companion to
applied regression</em>. Retrieved from <a
href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>
</div>
<div id="ref-FriendlyMeyer:2016:DDAR" class="csl-entry">
Friendly, M., &amp; Meyer, D. (2016). <em>Discrete data analysis with
<span>R</span>: Visualization and modeling techniques for categorical
and count data</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.
</div>
<div id="ref-R-ggeffects" class="csl-entry">
Lüdecke, D. (2023). <em>Ggeffects: Create tidy data frames of marginal
effects for ggplot from model outputs</em>. Retrieved from <a
href="https://strengejacke.github.io/ggeffects/">https://strengejacke.github.io/ggeffects/</a>
</div>
<div id="ref-R-broom" class="csl-entry">
Robinson, D., Hayes, A., &amp; Couch, S. (2023). <em>Broom: Convert
statistical objects into tidy tibbles</em>. Retrieved from <a
href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>
</div>
<div id="ref-nnet2002" class="csl-entry">
Venables, W. N., &amp; Ripley, B. D. (2002). <em>Modern applied
statistics with s</em> (Fourth). New York: Springer. Retrieved from <a
href="https://www.stats.ox.ac.uk/pub/MASS4/">https://www.stats.ox.ac.uk/pub/MASS4/</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>
