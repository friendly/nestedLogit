<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nestedLogit">
<title>Nested-dichotomies logistic regression models • nestedLogit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested-dichotomies logistic regression models">
<meta property="og:description" content="nestedLogit">
<meta property="og:image" content="http://friendly.github.io/nestedLogit/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nestedLogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/nestedLogit.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/plotting.html">Plotting nestedLogit models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/nestedLogit/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Nested-dichotomies logistic regression models</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly and John Fox</h4>
            
            <h4 data-toc-skip class="date">2023-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/nestedLogit/blob/HEAD/vignettes/nestedLogit.Rmd" class="external-link"><code>vignettes/nestedLogit.Rmd</code></a></small>
      <div class="d-none name"><code>nestedLogit.Rmd</code></div>
    </div>

    
    
<p>Load the packages we’ll use here:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/nestedLogit" class="external-link">nestedLogit</a></span><span class="op">)</span>    <span class="co"># Nested Dichotomy Logistic Regression Models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>          <span class="co"># A General-Purpose Package for Dynamic Report Generation in R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>            <span class="co"># Companion to Applied Regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span>           <span class="co"># Feed-Forward Neural Networks and Multinomial Log-Linear Models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>          <span class="co"># Convert Statistical Objects into Tidy Tibbles</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>          <span class="co"># A Grammar of Data Manipulation</span></span></code></pre></div>
<div class="section level2">
<h2 id="models-for-polytomous-responses">Models for polytomous responses<a class="anchor" aria-label="anchor" href="#models-for-polytomous-responses"></a>
</h2>
<p>The familiar logistic-regression model applies when there is a binary
(“<em>dichotomous</em>”) response, such as “survived” vs. “died”, or
voted “yes” vs. “no” on a referendum. Often, however, the response
variable is multi-category (“<em>polytomous</em>”), taking on <span class="math inline">\(m &gt; 2\)</span> discrete values. For
example,</p>
<ul>
<li><p>Respondents to a social survey are classified by their highest
completed level of education, taking on the values (1) less than
highschool, (2) highschool graduate, (3) some post-secondary, or (4)
post-secondary degree.</p></li>
<li><p>Women’s labor-force participation is classified as (1) not
working outside the home, (2) working parttime, or (3) working
fulltime.</p></li>
<li><p>Voters in Quebec in a Canadian national election choose one of
the (1) Liberal Party, (2) Conservative Party, (3) New Democratic Party,
or (4) Bloc Quebecois.</p></li>
</ul>
<p>The numbers in these examples, (1), (2), etc., are category labels,
and the categories may be ordered (as in the first two examples) or may
not (as in the third).</p>
<p>There are several different ways to model the category probabilities
for a polytomous response. Let <span class="math inline">\(\phi_{ij}
\equiv \phi_j \, ( \vec{x}_i )\)</span> be the probability of response
<span class="math inline">\(j\)</span> for case <span class="math inline">\(i\)</span>, given the predictors <span class="math inline">\(\vec{x}_i\)</span>. Because <span class="math inline">\(\sum_j \, \phi_{ij} = 1\)</span>, any <span class="math inline">\(m - 1\)</span> of these probabilities imply the
last; for example, <span class="math inline">\(\phi_{im} = 1 - \sum_{j =
1}^{m - 1} \, \phi_{ij}\)</span>. The essential idea is to construct a
model for the polytomous response composed of <span class="math inline">\(m-1\)</span> logit comparisons among the response
categories in a manner analogous to to the treatment of factors in the
predictor variables. There are also more restrictive models specifically
for ordered categorical responses, but we will not consider them
here.</p>
<div class="section level3">
<h3 id="multinomial-logit-model">Multinomial logit model<a class="anchor" aria-label="anchor" href="#multinomial-logit-model"></a>
</h3>
<p>One natural generalization of the the standard logistic-regression
(or <em>logit</em>) model is the <em>multinomial logit</em> (or
<em>generalized logit</em>) model. When the polytomous response has
<span class="math inline">\(m\)</span> levels, the multinomial logit
model comprises <span class="math inline">\(m-1\)</span> log-odds
comparisons with a reference level, typically the first or last, as
described in <span class="citation">Fox (2016, sec. 14.2.1)</span> and
<span class="citation">Friendly &amp; Meyer (2016, sec. 8.3)</span>.
This is an inessential choice, in that the likelihood under the model
and the fitted response probabilities that it produces are unaffected by
choice of reference level, much as choice of reference level for dummy
regressors created from a factor predictor doesn’t affect the fit of a
regression model. The standard implementation of this model in R is
<code><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">multinom()</a></code> in the <strong>nnet</strong> package <span class="citation">(Venables &amp; Ripley, 2002)</span>, which takes the
first level of the response as the omitted reference category.</p>
</div>
<div class="section level3">
<h3 id="nested-dichotomies-logit-model">Nested-dichotomies logit model<a class="anchor" aria-label="anchor" href="#nested-dichotomies-logit-model"></a>
</h3>
<p>Because it uses the familiar dichotomous logit model, fitting
separate models for each of a hierarchically nested set of binary
comparisons among the response categories, the
<em>nested-dichotomies</em> logit model can be a simpler alternative to
the multinomial logit model. Standard methods for model summaries, tests
and graphs can then be employed for each of the constituent binary logit
models, and taken together, the set of <span class="math inline">\(m-1\)</span> models comprises a complete model for
the polytomous response, just as the multinomial logit model does. This
approach is described by <span class="citation">Fienberg (1980)</span>
and is also discussed by <span class="citation">Fox (2016, sec.
14.2.2)</span> and <span class="citation">Friendly &amp; Meyer (2016,
sec. 8.2)</span>.</p>
<p>For an <span class="math inline">\(m\)</span>-category response and a
model-matrix with <span class="math inline">\(p\)</span> regressors,
both the nested-dichotomies logit model and the multinomial logit model
have <span class="math inline">\(p \times (m - 1)\)</span> parameters.
The models are not equivalent, however, in that they generally produce
different sets of fitted category probabilities and hence different
likelihoods.</p>
<p>By the construction of nested dichotomies, the submodels are
statistically independent (because the likelihood for the polytomous
response is the product of the likelihoods for the dichotomies), so test
statistics, such as likelihood ratio (<span class="math inline">\(G^2\)</span>) and Wald chi-square tests for
regression coefficients can be summed to give overall tests for the full
polytomy. In this way, the <span class="math inline">\(m-1\)</span>
dichotomies are analogous to <span class="math inline">\(m-1\)</span>
orthogonal contrasts for an <span class="math inline">\(m\)</span>-level
factor in a balanced ANOVA design.</p>
<p>Alternative sets of nested dichotomies are illustrated in the figure
below, for a four-category polytomous response response <span class="math inline">\(Y = \{1, 2, 3, 4\}\)</span>. In the case shown at
the left of the figure, the response categories are divided first as
<span class="math inline">\(\{1, 2\}\)</span> vs. <span class="math inline">\(\{3, 4\}\)</span>. Then these compound categories
are subdivided as the dichotomies <span class="math inline">\(\{1\}\)</span> vs. <span class="math inline">\(\{2\}\)</span> and as <span class="math inline">\(\{3\}\)</span> vs. <span class="math inline">\(\{4\}\)</span>. Alternatively, as shown at the
right of the figure, the response categories are divided progressively:
first as <span class="math inline">\(\{1\}\)</span> vs. <span class="math inline">\(\{2, 3, 4\}\)</span>; next as <span class="math inline">\(\{2\}\)</span> vs. <span class="math inline">\(\{3, 4\}\)</span>; and and finally <span class="math inline">\(\{3\}\)</span> vs. <span class="math inline">\(\{4\}\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="nested.jpg" alt="**Nested dichotomies**: The boxes show two different ways a four-category response can be represented as three nested dichotomies." width="80%"><p class="caption">
<strong>Nested dichotomies</strong>: The boxes show two different ways a
four-category response can be represented as three nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested.jpg")) -->
<p>This example makes clear that nested dichotomies are not unique and
that alternative sets of nested dichotomies are not equivalent:
Different choices have different interpretations. Moreover, and more
fundamentally, fitted probabilities and hence the likelihood for the
nested-dichotomies model depend on how the nested dichotomies are
defined.</p>
<p>The nested-dichotomies model is consequently most compelling when
there is a natural and unique way to define the dichotomies, such as a
process that proceeds through an orderly sequence of stages. Consider
the set of nested dichotomies at the right of the figure above, and the
previously mentioned four-level educational response variable with
categories (1) less than highschool, (2) highschool graduate, (3) some
post-secondary, and (4) post-secondary degree. In the vast majority of
cases, individuals proceed through these educational stages in sequence.
The first dichotomy, <span class="math inline">\(\{1\}\)</span>
vs. <span class="math inline">\(\{2, 3, 4\}\)</span>, therefore
represents highschool graduation; the second, <span class="math inline">\(\{2\}\)</span> vs. <span class="math inline">\(\{3, 4\}\)</span>, enrollment in post-secondary
education; and the third, <span class="math inline">\(\{3\}\)</span>
vs. <span class="math inline">\(\{4\}\)</span>, completion of a
post-secondary degree. This scheme for generating the a
nested-dichotomies logit model is termed <em>continuation
logits</em>.</p>
<p>To take another example, the figure below shows the classification of
psychiatric patients into four diagnostic categories. These might be
naturally dichotomized by contrasting the normal individuals to the
groups of patients, and then dividing the patient groups into a
comparison of depressed and manic patients vs. schizophrenics, followed
by a comparison of depressed vs. manic patients. A model predicting
diagnosis can be interpreted in terms of the probabilities of
classification into each of the response categories.</p>
<div class="figure" style="text-align: center">
<img src="nested-psychiatric.png" alt="**Psychiatric classification**: The figure shows how four diagnostic categories might be represented by nested dichotomies." width="70%"><p class="caption">
<strong>Psychiatric classification</strong>: The figure shows how four
diagnostic categories might be represented by nested dichotomies.
</p>
</div>
<!-- knitr::include_graphics(here::here("vignettes", "fig", "nested-psychiatric.png")) -->
</div>
</div>
<div class="section level2">
<h2 id="example-womens-labor-force-participation">Example: Women’s labor-force participation<a class="anchor" aria-label="anchor" href="#example-womens-labor-force-participation"></a>
</h2>
<p>For a principal example, we consider the data set
<code>Womenlf</code> from the <strong>carData</strong> package <span class="citation">(Fox, Weisberg, &amp; Price, 2022)</span>. The data
give the responses of 263 young married women, 21–30 years old, drawn
from a 1977 survey carried out by the York University Institute for
Social Research <span class="citation">(Atkinson, Blishen, Ornstein,
&amp; Stevenson, 1984)</span>. This example was originally developed by
<span class="citation">Fox (1984, sec. 5.1.5)</span>. The variables in
the model are:</p>
<ul>
<li>
<code>partic</code>: labor force participation, the response, with
levels:
<ul>
<li>
<code>"fulltime"</code>: working full-time</li>
<li>
<code>"not.work"</code>: not working outside the home</li>
<li>
<code>"parttime"</code> : working part-time.</li>
</ul>
</li>
<li>
<code>hincome</code>: Husband’s income, in $1,000s.</li>
<li>
<code>children</code>: Presence of children in the home,
<code>"absent"</code> or <code>"present"</code>.</li>
<li>
<code>region</code>: Region of Canada (“Atlantic”, “BC”, “Ontario”,
“Prairie”, “Quebec”).</li>
</ul>
<p>The response, <code>partic</code> is a factor, but the levels are
ordered alphabetically. To facilitate interpretation, we reorder the
levels of <code>partic</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Womenlf</span>, package <span class="op">=</span> <span class="st">"carData"</span><span class="op">)</span></span>
<span><span class="va">Womenlf</span><span class="op">$</span><span class="va">partic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Womenlf</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">partic</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In 1977, the majority of the 263 women in the sample were not working
outside the home:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">partic</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt; partic</span></span>
<span><span class="co">#&gt; not.work parttime fulltime </span></span>
<span><span class="co">#&gt;      155       42       66</span></span></code></pre></div>
<div class="section level3">
<h3 id="defining-nested-dichotomies">Defining nested dichotomies<a class="anchor" aria-label="anchor" href="#defining-nested-dichotomies"></a>
</h3>
<p>How can we understand these womens’ labor-force participation choices
in terms of the explanatory variables? We’ll consider three polytomous
logit models for the <code>Womenlf</code> data, two of which entail
different choices of nested dichotomies, and the multinomial logit
model. The example will illustrate the potential pitfalls and advantages
of the nested-dichotomies approach in a context where there isn’t a
compelling choice of nested dichotomies.</p>
<p>It is at least arguable to construe a woman’s labor-force choice as
first involving a dichotomy (let’s call it <code>work</code>) between
women who are not working outside the home vs. those who are working
(either parttime or fulltime). A second dichotomy (<code>full</code>)
contrasts those who work fulltime time vs. parttime, but among only
those who work.</p>
<p>The two binary variables for the nested dichotomies can be created by
recoding <code>partic</code> as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Womenlf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">Womenlf</span>, <span class="op">{</span></span>
<span>  <span class="va">work</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">==</span> <span class="st">"not.work"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">full</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">==</span> <span class="st">"fulltime"</span>,  <span class="fl">1</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">==</span> <span class="st">"parttime"</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Note that the complete sample of 263 cases is available for the
<code>work</code> dichotomy, while only 108 cases—excluding those not
working outside the home—are available for the <code>full</code>
dichotomy:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">work</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt; work</span></span>
<span><span class="co">#&gt;   0   1 </span></span>
<span><span class="co">#&gt; 155 108</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">full</span>, data<span class="op">=</span><span class="va">Womenlf</span>, addNA<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; full</span></span>
<span><span class="co">#&gt;    0    1 &lt;NA&gt; </span></span>
<span><span class="co">#&gt;   42   66  155</span></span></code></pre></div>
<p>The relationship of the response variable <code>partic</code> to the
two nested dichotomies is as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">partic</span> <span class="op">+</span> <span class="va">work</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt;           work</span></span>
<span><span class="co">#&gt; partic       0   1</span></span>
<span><span class="co">#&gt;   not.work 155   0</span></span>
<span><span class="co">#&gt;   parttime   0  42</span></span>
<span><span class="co">#&gt;   fulltime   0  66</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">partic</span> <span class="op">+</span> <span class="va">full</span>, addNA<span class="op">=</span><span class="cn">TRUE</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt;           full</span></span>
<span><span class="co">#&gt; partic       0   1 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   not.work   0   0  155</span></span>
<span><span class="co">#&gt;   parttime  42   0    0</span></span>
<span><span class="co">#&gt;   fulltime   0  66    0</span></span></code></pre></div>
<p>We can then fit separate binary logit models to the two nested
dichotomies directly:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod.work</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">work</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="va">mod.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">full</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span></code></pre></div>
<p>In equation form, the two log-odds models are shown below. (Model
equations are conveniently rendered in markdown/LaTeX using the
<code>equatiomatic</code> package <span class="citation">(Anderson,
Heiss, &amp; Sumners, 2023)</span>.)
<!-- equatiomatic::extract_eq(mod.work) -->
<!-- equatiomatic::extract_eq(mod.work) --></p>
<p><span class="math display">\[
L_1 =\log\left[ \frac { P( \operatorname{work} = \operatorname{1} ) }{ 1
- P( \operatorname{work} = \operatorname{1} ) } \right] = \alpha_1 +
\beta_{11}(\operatorname{hincome}) +
\beta_{12}(\operatorname{children}_{\operatorname{present}})
\]</span> <span class="math display">\[
L_2 = \log\left[ \frac { P( \operatorname{full} ) }{ 1 - P(
\operatorname{full} ) } \right] = \alpha_2 +
\beta_{21}(\operatorname{hincome}) +
\beta_{22}(\operatorname{children}_{\operatorname{present}})
\]</span> The estimated regression coefficients for the two binary logit
models are</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod.work</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = work ~ hincome + children, family = binomial, data = Womenlf)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span><span class="co">#&gt;          1.3358          -0.0423          -1.5756  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 262 Total (i.e. Null);  260 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       356 </span></span>
<span><span class="co">#&gt; Residual Deviance: 320   AIC: 326</span></span>
<span><span class="va">mod.full</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = full ~ hincome + children, family = binomial, data = Womenlf)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span><span class="co">#&gt;           3.478           -0.107           -2.651  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 107 Total (i.e. Null);  105 Residual</span></span>
<span><span class="co">#&gt;   (155 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Null Deviance:       144 </span></span>
<span><span class="co">#&gt; Residual Deviance: 104   AIC: 110</span></span></code></pre></div>
<p>A disadvantage of this approach is that it is tedious to obtain tests
for the combined model, to compute and plot predicted probabilities, and
so forth.</p>
</div>
<div class="section level3">
<h3 id="using-dichotomy-and-logits-to-define-the-response">Using <code>dichotomy()</code> and <code>logits()</code> to define
the response<a class="anchor" aria-label="anchor" href="#using-dichotomy-and-logits-to-define-the-response"></a>
</h3>
<p>Instead, the <strong>nestedLogit</strong> package provides tools to
specify and manipulate the nested-logit model. The
<code><a href="../reference/nestedLogit.html">dichotomy()</a></code> function defines a single dichotomy, and the
<code><a href="../reference/nestedLogit.html">logits()</a></code> function uses <span class="math inline">\(m-1\)</span> calls to <code><a href="../reference/nestedLogit.html">dichotomy()</a></code> to
create a <code>"dichotomies"</code> object representing the nested
dichotomies. For example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nestedLogit.html">logits</a></span><span class="op">(</span>work<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"not.work"</span>, working<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      full<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparisons</span></span>
<span><span class="co">#&gt; work: {not.work} vs. working{parttime, fulltime}</span></span>
<span><span class="co">#&gt; full: {parttime} vs. {fulltime}</span></span></code></pre></div>
<p>It is mandatory to name the dichotomies (here <code>work</code> and
<code>full</code>), and we can optionally name the elements of each
dichotomy, an option that is particularly useful for a compound
category, such as <code>working=c("parttime", "fulltime")</code> in the
example.</p>
<p>There are coercion functions to convert the set of nested dichotomies
to a matrix or to a character string, representing the tree structure of
the dichotomies:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span></span>
<span><span class="co">#&gt;      not.work parttime fulltime</span></span>
<span><span class="co">#&gt; work        0        1        1</span></span>
<span><span class="co">#&gt; full       NA        0        1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; work = {{not.work}} {working{parttime fulltime}}; full = {{parttime}} {{fulltime}}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-nestedlogit-to-fit-the-model">Using <code>nestedLogit()</code> to fit the model<a class="anchor" aria-label="anchor" href="#using-nestedlogit-to-fit-the-model"></a>
</h3>
<p>To fit the model, we supply <code>comparisons</code> as the
<code>dichotomies</code> argument to the <code><a href="../reference/nestedLogit.html">nestedLogit()</a></code>
function. The model <code>formula</code> argument,
<code>partic ~ hincome + children</code> specifies a main-effects model
for husband’s income and presence of young children; aside from the
<code>dichotomies</code> argument, the general format of the function
call is typical for an R statistical modeling function (with optional
<code>subset</code> and <code>contrasts</code> arguments not shown in
this example). An atypical feature of <code><a href="../reference/nestedLogit.html">nestedLogit()</a></code> is that
the <code>data</code> argument is required.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nestedLogit.html">nestedLogit</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, </span>
<span>                          dichotomies <span class="op">=</span> <span class="va">comparisons</span>,</span>
<span>                          data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span></code></pre></div>
<p>The result, <code>wlf.nested</code>, is a an object of class
<code>"nestedLogit"</code>, encapsulating the details of the model for
the nested dichotomies. The <code>models</code> component of the object
contains essentially the same <code>"glm"</code> model objects as we
constructed directly as <code>mod.work</code> and <code>mod.full</code>
above, here named <code>work</code> and <code>full</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "models"          "formula"         "dichotomies"     "data"           </span></span>
<span><span class="co">#&gt; [5] "data.name"       "subset"          "contrasts"       "contrasts.print"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">$</span><span class="va">models</span><span class="op">)</span> <span class="co"># equivalent: names(models(wlf.models))</span></span>
<span><span class="co">#&gt; [1] "work" "full"</span></span>
<span></span>
<span><span class="co"># view the separate models; same as lapply(models(wlf.nested), I)</span></span>
<span><span class="fu"><a href="../reference/models.html">models</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = work ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span><span class="co">#&gt;          1.3358          -0.0423          -1.5756  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 262 Total (i.e. Null);  260 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       356 </span></span>
<span><span class="co">#&gt; Residual Deviance: 320   AIC: 326</span></span>
<span></span>
<span><span class="fu"><a href="../reference/models.html">models</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = full ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;     (Intercept)          hincome  childrenpresent  </span></span>
<span><span class="co">#&gt;           3.478           -0.107           -2.651  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 107 Total (i.e. Null);  105 Residual</span></span>
<span><span class="co">#&gt;   (155 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Null Deviance:       144 </span></span>
<span><span class="co">#&gt; Residual Deviance: 104   AIC: 110</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="methods-for-nestedlogit-objects">Methods for <code>"nestedLogit"</code> objects<a class="anchor" aria-label="anchor" href="#methods-for-nestedlogit-objects"></a>
</h3>
<p>As befits a model-fitting function, the package defines a nearly
complete set of methods for <code>"nestedLogit"</code> objects:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> print the results
for each of the submodels.</li>
<li>
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> re-fits the model, allowing changes to the
model <code>formula</code>, <code>data</code>, <code>subset</code>, and
<code>contrasts</code> arguments.</li>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> returns the coefficients for the predictors in
each dichotomy.</li>
<li>
<code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> returns the variance-covariance matrix of the
coefficients</li>
<li>
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> computes predicted probabilities for the
response categories, either for the cases in the data, which is
equivalent to <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>, or for arbitrary combinations of
the predictors; the latter is useful for producing plots to aid
interpretation.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> are extensions of
<code><a href="https://broom.tidymodels.org/reference/glance.glm.html" class="external-link">broom::glance.glm()</a></code> and <code><a href="https://broom.tidymodels.org/reference/tidy.glm.html" class="external-link">broom::tidy.glm()</a></code> to
obtain compact summaries of a <code>"nestedLogit"</code> model
object.</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> provides basic plots of the predicted
probabilities over a range of values of the predictor variables.</li>
<li>
<code><a href="../reference/models.html">models()</a></code> is an extractor function for the binary logit
models in the <code>"nestedLogit"</code> object</li>
</ul>
<p>These functions are supplemented by various methods for testing
hypotheses about and comparing nested-logit models:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> provides analysis-of-deviance Type I
(sequential) tests for each dichotomy and for the combined model. When
given a sequence of model objects, <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> tests the models
against one another in the order specified.</li>
<li>
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> uses <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> to provide
analysis-of-deviance Type II or III (partial) tests for each dichotomy
and for the combined model.</li>
<li>
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> computes Wald tests for hypotheses
about coefficients or their linear combinations.</li>
<li>
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code> returns the log-likelihood and degrees of
freedom for the nested-dichotomies logit model.</li>
<li>Through <code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>, the <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code> and
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code> functions compute the Akaike and Bayesian information
criteria model-comparison statistics.</li>
</ul>
<p>We illustrate the application of some of these methods:</p>
<p><strong>Coefficients</strong>: By default, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>
returns a matrix whose rows are the regressors in the model and whose
columns represent the nested dichotomies. In the <code>Womenlf</code>
example, the coefficients <span class="math inline">\(\widehat{\beta}_{j1}\)</span> give the estimated
change in the log-odds of working vs. not working associated with a
$1,000 increase in husband’s income and with having children present
vs. absent, each holding the other constant. The coefficients <span class="math inline">\(\widehat{\beta}_{j2}\)</span> are similar for the
log-odds of working fulltime vs. parttime among those who are working
outside the home. The exponentiated coefficients <span class="math inline">\(e^{\widehat{\beta}_{jk}}\)</span> give
multiplicative effects on the odds for these comparisons.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     work    full</span></span>
<span><span class="co">#&gt; (Intercept)      1.33583  3.4778</span></span>
<span><span class="co">#&gt; hincome         -0.04231 -0.1073</span></span>
<span><span class="co">#&gt; childrenpresent -1.57565 -2.6515</span></span>
<span></span>
<span><span class="co"># show as odds ratios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   work     full</span></span>
<span><span class="co">#&gt; (Intercept)     3.8032 32.38753</span></span>
<span><span class="co">#&gt; hincome         0.9586  0.89829</span></span>
<span><span class="co">#&gt; childrenpresent 0.2069  0.07055</span></span></code></pre></div>
<p>Thus, the odds of both working and working fulltime decrease with
husband’s income, by about 4% and 10% respectively per $1000. Having
young children also decreases the odds of both working and working
fulltime, by about 79% and 93% respectively.</p>
<p><strong>Analysis of deviance</strong>: A method for the
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> function from the <strong>car</strong> package
<span class="citation">(Fox &amp; Weisberg, 2019)</span> computes Type
II or III likelihood-ratio or Wald tests for each term in the model.
Note that the likelihood-ratio or Wald <span class="math inline">\(\chi^2\)</span> and degrees of freedom for the
<code>Combined Responses</code> is the sum of their values for the
separate dichotomies:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      4.83  1      0.028 *  </span></span>
<span><span class="co">#&gt; children    31.32  1    2.2e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome       9.0  1     0.0027 ** </span></span>
<span><span class="co">#&gt; children     32.1  1    1.4e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      13.8  2      0.001 ** </span></span>
<span><span class="co">#&gt; children     63.5  2    1.7e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>Linear hypotheses</strong>: The
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> function in the <strong>car</strong>
package provides a very general method for computing Wald tests of
specific hypotheses about individual coefficients in a model or their
linear combinations.</p>
<p>For example, the following command tests the hypothesis that the
coefficients for <code>hincome</code> and <code>children</code> are
simultaneously all equal to zero. This is equivalent to the test of the
global null model, <span class="math inline">\(H_0\)</span>: all <span class="math inline">\(\beta_{jk} = 0\)</span> for <span class="math inline">\(j = 1,2; k=1,2\)</span> against an alternative
that one or more coefficients <span class="math inline">\(\beta_{jk} \ne
0\)</span>.</p>
<p><code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> reports this test for each of the
submodels for the dichotomies <code>work</code> and <code>full</code>,
as well as for the combined model:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hincome"</span>, <span class="st">"childrenpresent"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear hypothesis test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hypothesis: </span></span>
<span><span class="co">#&gt; hincome = 0 </span></span>
<span><span class="co">#&gt; childrenpresent = 0 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Model 1: restricted model</span></span>
<span><span class="co">#&gt; Model 2: partic ~ hincome + children </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime} </span></span>
<span><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; 1    262                        </span></span>
<span><span class="co">#&gt; 2    260  2  32.2      1e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Res.Df Df Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; 1    107                        </span></span>
<span><span class="co">#&gt; 2    105  2  25.6    2.8e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt; Chisq = 57.813, Df = 4, Pr(&gt;Chisq) = 8.4e-12</span></span></code></pre></div>
<p><strong>Tidy summaries</strong>: The <strong>broom</strong> package
<span class="citation">(Robinson, Hayes, &amp; Couch, 2023)</span>
provides functions for compact and tidy summaries of fitted models. The
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> method for a <code>"nestedLogit"</code> model
produces a one-line summary of the statistics for each dichotomy. The
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> method combines the coefficients for the sub-models,
together with test statistics:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span>   <span class="co"># summarize the sub-models</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   response null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> work              356.     262 -<span style="color: #BB0000;">160.</span>   326.  336.     320.         260   263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> full              144.     107  -<span style="color: #BB0000;">52.2</span>  110.  119.     104.         105   108</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span>     <span class="co"># summarize the coefficients</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   response term            estimate std.error statistic      p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> work     (Intercept)       1.34      0.384       3.48 0.000<span style="text-decoration: underline;">500</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> work     hincome          -<span style="color: #BB0000;">0.042</span><span style="color: #BB0000; text-decoration: underline;">3</span>    0.019<span style="text-decoration: underline;">8</span>     -<span style="color: #BB0000;">2.14</span> 0.032<span style="text-decoration: underline;">4</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> work     childrenpresent  -<span style="color: #BB0000;">1.58</span>      0.292      -<span style="color: #BB0000;">5.39</span> 0.000<span style="text-decoration: underline;">000</span>070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> full     (Intercept)       3.48      0.767       4.53 0.000<span style="text-decoration: underline;">005</span>80  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> full     hincome          -<span style="color: #BB0000;">0.107</span>     0.039<span style="text-decoration: underline;">2</span>     -<span style="color: #BB0000;">2.74</span> 0.006<span style="text-decoration: underline;">15</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> full     childrenpresent  -<span style="color: #BB0000;">2.65</span>      0.541      -<span style="color: #BB0000;">4.90</span> 0.000<span style="text-decoration: underline;">000</span>957</span></span></code></pre></div>
<p>These functions facilitate the construction of custom tables. For
example, to extract the likelihood-ratio difference-in-deviance (<span class="math inline">\(G^2\)</span>) tests and compute (<span class="math inline">\(G^2 / df\)</span>):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="va">gl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">deviance</span>, <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>response <span class="op">=</span> <span class="st">"Combined"</span>, deviance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gl</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span>, df.residual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gl</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    `P-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">deviance</span>, <span class="va">df.residual</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    `$G^2$/df` <span class="op">=</span> <span class="va">deviance</span> <span class="op">/</span> <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>`$G^2$` <span class="op">=</span> <span class="va">deviance</span>,</span>
<span>         df <span class="op">=</span> <span class="va">df.residual</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">response</th>
<th align="right"><span class="math inline">\(G^2\)</span></th>
<th align="right">df</th>
<th align="right">P-value</th>
<th align="right">
<span class="math inline">\(G^2\)</span>/df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">work</td>
<td align="right">319.7</td>
<td align="right">260</td>
<td align="right">0.007</td>
<td align="right">1.230</td>
</tr>
<tr class="even">
<td align="left">full</td>
<td align="right">104.5</td>
<td align="right">105</td>
<td align="right">0.496</td>
<td align="right">0.995</td>
</tr>
<tr class="odd">
<td align="left">Combined</td>
<td align="right">424.2</td>
<td align="right">365</td>
<td align="right">0.018</td>
<td align="right">1.162</td>
</tr>
</tbody>
</table>
<p><strong>Model updating</strong>: The <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function
makes it easy to create a new model from an old one, by adding or
subtracting terms from the model formula, specifying a new formula, or
changing the observations used or contrasts for factors.</p>
<p>For example, you might ask, “<em>Does it make sense to include region
of Canada in the model for the <code>Womenlf</code> data?</em>” This
question can be answered by adding <code>region</code> to the model
formula, and comparing the new model to the original one using
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>. The tests here are for the additional contribution
of <code>region</code> over and above the main effects of
<code>hincome</code> and <code>children</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">wlf.nested</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">region</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="va">wlf.nested.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span><span class="co">#&gt;  Model 2: partic ~ hincome + children + region </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       260        320                     </span></span>
<span><span class="co">#&gt; 2       256        317  4     2.43     0.66</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       105        104                     </span></span>
<span><span class="co">#&gt; 2       101        102  4     2.65     0.62</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       365        424                     </span></span>
<span><span class="co">#&gt; 2       357        419  8     5.08     0.75</span></span></code></pre></div>
<p>Recall that <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> with two or models tests the models
sequentially against one another, in the order specified. This assumes
that the models compared are <em>nested</em> (an unintentional a pun),
in the sense that the terms in the smaller model in each sequential pair
are a subset of those in the larger model.</p>
<p>In a similar manner, we could fit and test a <em>wider</em> scope of
models. For example to add an interaction between husband’s income and
children and then test the interaction term:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">wlf.nested</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="va">wlf.nested.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables</span></span>
<span><span class="co">#&gt;  Model 1: partic ~ hincome + children</span></span>
<span><span class="co">#&gt;  Model 2: partic ~ hincome + children + hincome:children </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response work: {not.work} vs. working{parttime, fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       260        320                     </span></span>
<span><span class="co">#&gt; 2       259        319  1    0.608     0.44</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: {parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       105        104                     </span></span>
<span><span class="co">#&gt; 2       104        104  1    0.256     0.61</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       365        424                     </span></span>
<span><span class="co">#&gt; 2       363        423  2    0.864     0.65</span></span></code></pre></div>
<p>We can see that neither <code>region</code> nor the
<code>hincome</code> <span class="math inline">\(\times\)</span>
<code>children</code> interaction make a difference to the fit either of
the sub-models or of the combined model for the three response
categories.</p>
</div>
<div class="section level3">
<h3 id="obtaining-fitted-values-predict">Obtaining fitted values: <code>predict()</code><a class="anchor" aria-label="anchor" href="#obtaining-fitted-values-predict"></a>
</h3>
<p>By default, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> for a <code>"nestedLogit"</code>
model object returns the predicted probabilities
(<code>type = "response"</code>) of each of the response categories for
<em>all</em> observations in the data set: The computation is a bit
tricky, because the probabilities of working full time or part time are
conditional on working outside the home, but <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
takes care of the details.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/some.html" class="external-link">some</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     not.work parttime fulltime</span></span>
<span><span class="co">#&gt; 13    0.6504  0.18696  0.16268</span></span>
<span><span class="co">#&gt; 27    0.7396  0.20070  0.05974</span></span>
<span><span class="co">#&gt; 134   0.3222  0.08251  0.59525</span></span>
<span><span class="co">#&gt; 137   0.6968  0.20093  0.10226</span></span>
<span><span class="co">#&gt; 143   0.6693  0.19426  0.13640</span></span>
<span><span class="co">#&gt; 182   0.3410  0.09661  0.56240</span></span>
<span><span class="co">#&gt; 198   0.7925  0.18197  0.02556</span></span>
<span><span class="co">#&gt; 212   0.6878  0.19929  0.11291</span></span>
<span><span class="co">#&gt; 242   0.3131  0.07607  0.61087</span></span>
<span><span class="co">#&gt; 257   0.2225  0.02865  0.74886</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-nestedlogit-objects">Plotting <code>"nestedLogit"</code> objects<a class="anchor" aria-label="anchor" href="#plotting-nestedlogit-objects"></a>
</h3>
<p>The <strong>nestedLogit</strong> package includes a basic
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code>"nestedLogit"</code> models, which
calculates fitted probabilities for the response categories and plots
these against a single explanatory variable on the horizontal axis,
while <code>other</code> explanatory variables are fixed to particular
values. To produce multi-panel plots, it is necessary to call
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> repeatedly for various levels of the other
predictors, and to compose these into a single figure, for example using
<code>par("mfcol")</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"absent"</span><span class="op">)</span>, <span class="co"># left panel</span></span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend.location<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"present"</span><span class="op">)</span>, <span class="co"># right panel</span></span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-plot-1.png" alt="**plot method**: Predicted probabilities of working at all or working part time or full time" width="100%"><p class="caption">
<strong>plot method</strong>: Predicted probabilities of working at all
or working part time or full time
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p>We provide a separate vignette on constructing custom graphs of
<code>"nestedLogit"</code> objects.</p>
</div>
<div class="section level3">
<h3 id="alternative-models-for-the-womenlf-data">Alternative models for the <code>Womenlf</code> data<a class="anchor" aria-label="anchor" href="#alternative-models-for-the-womenlf-data"></a>
</h3>
<p>We’ve mentioned that the nested dichotomies {not working}
vs. {parttime, fulltime} and {parttime} vs. {fulltime} for the
<code>Womenlf</code> data are largely arbitrary. An alternative set of
nested dichotomies first contrasts fulltime work with the other
categories, {fulltime} vs. {not working, parttime}, and then {not
working} vs. {part time}. The rationale is that the real hurdle for
young married women to enter the paid labor force is to combine fulltime
work outside the home with housework. This alternative
nested-dichotomies model proves enlightening:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.nested.alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nestedLogit.html">nestedLogit</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>,</span>
<span>                              <span class="fu"><a href="../reference/nestedLogit.html">logits</a></span><span class="op">(</span>full<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span>nonfulltime<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span><span class="op">)</span>, <span class="st">"fulltime"</span><span class="op">)</span>,</span>
<span>                                     part<span class="op">=</span><span class="fu"><a href="../reference/nestedLogit.html">dichotomy</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              data<span class="op">=</span><span class="va">Womenlf</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> for this model
show that the effects of husband’s income and children are significant
for the <code>full</code> model but not for the <code>part</code>
model:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Analysis of Deviance Tables (Type II tests)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Response full: nonfulltime{not.work, parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      15.1  1      1e-04 ***</span></span>
<span><span class="co">#&gt; children     63.6  1    1.6e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response part: {not.work} vs. {parttime}</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)</span></span>
<span><span class="co">#&gt; hincome    0.0851  1       0.77</span></span>
<span><span class="co">#&gt; children   0.0012  1       0.97</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Combined Responses</span></span>
<span><span class="co">#&gt;          LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; hincome      15.2  2    0.00051 ***</span></span>
<span><span class="co">#&gt; children     63.6  2    1.6e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Nested logit models: partic ~ hincome + children</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response full: nonfulltime{not.work, parttime} vs. {fulltime}</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = full ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></span>
<span><span class="co">#&gt; -1.745  -0.583  -0.443   0.242   2.378  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)       1.7696     0.4690    3.77  0.00016 ***</span></span>
<span><span class="co">#&gt; hincome          -0.0987     0.0277   -3.57  0.00036 ***</span></span>
<span><span class="co">#&gt; childrenpresent  -2.5631     0.3489   -7.35    2e-13 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 296.34  on 262  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 218.81  on 260  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 224.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response part: {not.work} vs. {parttime}</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = part ~ hincome + children, family = binomial, data = Womenlf, </span></span>
<span><span class="co">#&gt;     contrasts = contrasts)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></span>
<span><span class="co">#&gt; -0.757  -0.696  -0.688  -0.671   1.794  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; (Intercept)     -1.42758    0.58222   -2.45    0.014 *</span></span>
<span><span class="co">#&gt; hincome          0.00687    0.02343    0.29    0.769  </span></span>
<span><span class="co">#&gt; childrenpresent  0.01629    0.46762    0.03    0.972  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 204.16  on 196  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 204.07  on 194  degrees of freedom</span></span>
<span><span class="co">#&gt;   (66 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; AIC: 210.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>It’s apparent that the alternative model produces a simpler
description of the data: The predictors husband’s income and presence of
children affect the decision to work fulltime, but not the decision to
work parttime among those who aren’t engaged in fulltime work.</p>
<p>But do the fits of the two models to the data differ? We can compare
fitted probabilities under the two specifications:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; not.work parttime fulltime </span></span>
<span><span class="co">#&gt;   0.9801   0.9185   0.9961</span></span></code></pre></div>
<p>The correlations of the fitted probabilities are high but far from
perfect.</p>
<p>The two models have the same number of parameters and neither is
nested within the other, so a conventional likelihood-ratio test is
inappropriate, but we can still compare maximized log-likelihoods under
the two models:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">wlf.nested</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -212.1 (df=6)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -211.4 (df=6)</span></span></code></pre></div>
<p>Because the sample sizes and numbers of parameters are the same for
the two models, differences in AIC and BIC are just twice the
differences in the log-likelihoods; for example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">wlf.nested</span>, <span class="va">wlf.nested.alt</span><span class="op">)</span></span>
<span><span class="co">#&gt;                df   AIC</span></span>
<span><span class="co">#&gt; wlf.nested      6 436.2</span></span>
<span><span class="co">#&gt; wlf.nested.alt  6 434.9</span></span></code></pre></div>
<p>The comparison slightly favors the alternative nested-dichotomies
model.</p>
<p>Here’s a graph of the alternative model:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"absent"</span><span class="op">)</span>, <span class="co"># left panel</span></span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend.location<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wlf.nested.alt</span>, <span class="st">"hincome"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>children<span class="op">=</span><span class="st">"present"</span><span class="op">)</span>, <span class="co"># right panel</span></span>
<span>     xlab<span class="op">=</span><span class="st">"Husband's Income"</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-alt-plot-1.png" alt="Predicted probabilities for the alternative nested-dichotomies model" width="100%"><p class="caption">
Predicted probabilities for the alternative nested-dichotomies model
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p>Compare this to the previous graph for the original
specification.</p>
<p>It’s also of interest to compare the nested-dichotomies models to the
multinomial logit model, which, as we explained, treats the response
categories symmetrically:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wlf.multinom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">multinom</a></span><span class="op">(</span><span class="va">partic</span> <span class="op">~</span> <span class="va">hincome</span> <span class="op">+</span> <span class="va">children</span>, data <span class="op">=</span> <span class="va">Womenlf</span><span class="op">)</span></span>
<span><span class="co">#&gt; # weights:  12 (6 variable)</span></span>
<span><span class="co">#&gt; initial  value 288.935032 </span></span>
<span><span class="co">#&gt; iter  10 value 211.454772</span></span>
<span><span class="co">#&gt; final  value 211.440963 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wlf.multinom</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; multinom(formula = partic ~ hincome + children, data = Womenlf)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          (Intercept)   hincome childrenpresent</span></span>
<span><span class="co">#&gt; parttime      -1.432  0.006894         0.02146</span></span>
<span><span class="co">#&gt; fulltime       1.983 -0.097232        -2.55861</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Std. Errors:</span></span>
<span><span class="co">#&gt;          (Intercept) hincome childrenpresent</span></span>
<span><span class="co">#&gt; parttime      0.5925 0.02345          0.4690</span></span>
<span><span class="co">#&gt; fulltime      0.4842 0.02810          0.3622</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual Deviance: 422.9 </span></span>
<span><span class="co">#&gt; AIC: 434.9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">wlf.multinom</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -211.4 (df=6)</span></span></code></pre></div>
<p>Check the correlation between fitted probabilities:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wlf.multinom</span>, type<span class="op">=</span><span class="st">"probs"</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not.work"</span>, <span class="st">"parttime"</span>, <span class="st">"fulltime"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; not.work parttime fulltime </span></span>
<span><span class="co">#&gt;        1        1        1</span></span></code></pre></div>
<p>As it turns out, the multinomial logit model and the alternative
nested-dichotomies model produce nearly identical fits with similar
simple interpretations.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-R-equatiomatic" class="csl-entry">
Anderson, D., Heiss, A., &amp; Sumners, J. (2023). <em>Equatiomatic:
Transform models into LaTeX equations</em>.
</div>
<div id="ref-Atkinson-etal:1984" class="csl-entry">
Atkinson, T., Blishen, B. R., Ornstein, M. D., &amp; Stevenson, H. M.
(1984). <span class="nocase">Quality of Canadian Life: Social Change in
Canada</span>, 1977. ICPSR - Interuniversity Consortium for Political;
Social Research. http://doi.org/<a href="https://doi.org/10.3886/ICPSR07879.V1" class="external-link">10.3886/ICPSR07879.V1</a>
</div>
<div id="ref-Fienberg:80" class="csl-entry">
Fienberg, S. E. (1980). <em>The analysis of cross-classified categorical
data</em> (2nd ed.). Cambridge, MA: MIT Press.
</div>
<div id="ref-Fox:1984:LSM" class="csl-entry">
Fox, J. (1984). <em>Linear statistical models and related methods</em>.
New York: Wiley.
</div>
<div id="ref-Fox:2016:ARA" class="csl-entry">
Fox, J. (2016). <em>Applied regression analysis and generalized linear
models</em> (Third edition.). Los Angeles: SAGE.
</div>
<div id="ref-car2019" class="csl-entry">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to
applied regression</em> (Third). Thousand Oaks <span>CA</span>: Sage.
Retrieved from <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/" class="external-link">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>
</div>
<div id="ref-R-carData" class="csl-entry">
Fox, J., Weisberg, S., &amp; Price, B. (2022). <em>carData: Companion to
applied regression data sets</em>. Retrieved from <a href="https://CRAN.R-project.org/package=carData" class="external-link">https://CRAN.R-project.org/package=carData</a>
</div>
<div id="ref-FriendlyMeyer:2016:DDAR" class="csl-entry">
Friendly, M., &amp; Meyer, D. (2016). <em>Discrete data analysis with
<span>R</span>: Visualization and modeling techniques for categorical
and count data</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.
</div>
<div id="ref-R-broom" class="csl-entry">
Robinson, D., Hayes, A., &amp; Couch, S. (2023). <em>Broom: Convert
statistical objects into tidy tibbles</em>. Retrieved from <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>
</div>
<div id="ref-nnet2002" class="csl-entry">
Venables, W. N., &amp; Ripley, B. D. (2002). <em>Modern applied
statistics with s</em> (Fourth). New York: Springer. Retrieved from <a href="https://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">https://www.stats.ox.ac.uk/pub/MASS4/</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
