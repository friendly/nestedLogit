<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plotting nestedLogit models with ggplot2 • nestedLogit</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting nestedLogit models with ggplot2"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nestedLogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/nestedLogit.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plotting-ggplot.html">Plotting nestedLogit models with ggplot2</a></li>
    <li><a class="dropdown-item" href="../articles/standard-errors.html">Standard Errors of Fitted Category Probabilities by the Delta Method for the Nested Logit Model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/nestedLogit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting nestedLogit models with ggplot2</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly and John Fox</h4>
            
            <h4 data-toc-skip class="date">2026-02-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/nestedLogit/blob/HEAD/vignettes/plotting-ggplot.Rmd" class="external-link"><code>vignettes/plotting-ggplot.Rmd</code></a></small>
      <div class="d-none name"><code>plotting-ggplot.Rmd</code></div>
    </div>

    
    
<p>Load the packages we’ll use here:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(nestedLogit)    <span class="co"># Nested Dichotomy Logistic Regression Models</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(knitr)          <span class="co"># A General-Purpose Package for Dynamic Report Generation in R</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)          <span class="co"># A Grammar of Data Manipulation</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)          <span class="co"># Tidy Messy Data</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)        <span class="co"># Create Elegant Data Visualisations Using the Grammar of Graphics</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)   <span class="co"># Curved Text in &#39;ggplot2&#39;</span></span></code></pre></div>
<p>The main vignette illustrated the basic plot method,
<code>plot.nestedLogit()</code> in the package. However, for better
control of the details and possibly more pleasing graphs, it is useful
to describe how graphs can be constructed using <code>ggplot2</code>
<span class="citation">(Wickham et al., 2025)</span>. We’ll use the same
example of women’s labor force participation, using the original
dichotomies:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(Womenlf, <span class="at">package =</span> <span class="st">&quot;carData&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">logits</span>(<span class="at">work=</span><span class="fu">dichotomy</span>(<span class="st">&quot;not.work&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>)),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                      <span class="at">full=</span><span class="fu">dichotomy</span>(<span class="st">&quot;parttime&quot;</span>, <span class="st">&quot;fulltime&quot;</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>wlf.nested <span class="ot">&lt;-</span> <span class="fu">nestedLogit</span>(partic <span class="sc">~</span> hincome <span class="sc">+</span> children,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                          <span class="at">dichotomies =</span> comparisons,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                          <span class="at">data=</span>Womenlf)</span></code></pre></div>
<p>The advantages of this approach are that</p>
<ul>
<li>you can handle more complicated designs with more predictors by
faceting,</li>
<li>it allows you to plot either the fitted probabilities or their
transformed logits,</li>
<li>you can also obtain plots for log odds corresponding to each of the
dichotomies which comprise the nested logit model.</li>
</ul>
<p>As we will illustrate, this provides a nice visual interpretation of
the alternative specification of dichotomies for the
<code>Womenlf</code> data discussed in the section “Alternative models
for the <code>Womenlf</code> data” of the main vignette.</p>
<div id="fitted-probabilities" class="section level2">
<h2>Fitted probabilities</h2>
<p>To draw a plot, it is sufficient to calculate predicted probabilities
over a grid of values of the predictor variables. Here, we select a
range of 0 - 45 in steps of 5, combined with the two values of
<code>children</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">hincome=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                   <span class="at">children=</span><span class="fu">c</span>(<span class="st">&quot;absent&quot;</span>, <span class="st">&quot;present&quot;</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>pred.nested <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested, <span class="at">newdata =</span> new)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">names</span>(pred.nested)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;p&quot;        &quot;logit&quot;    &quot;se.p&quot;     &quot;se.logit&quot; &quot;.data&quot;</span></span></code></pre></div>
<p>As explained in <code>help(predict.nestedLogit)</code>, the predict
method returns a complicated structure – a list of four data frames
corresponding to the predicted probabilities for the response
categories, the corresponding logits, and each of their standard
errors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(pred.nested[[<span class="st">&quot;p&quot;</span>]])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;   not.work parttime fulltime</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 1   0.2082  0.02372   0.7681</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 2   0.2452  0.03785   0.7169</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 3   0.2864  0.05907   0.6545</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 4   0.3315  0.08936   0.5791</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 5   0.3800  0.12944   0.4906</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 6   0.4309  0.17691   0.3922</span></span></code></pre></div>
<p>However, <code>ggplot</code> wants the data in long format. This is
easily done using the <code>as.data.frame()</code> method, which also
includes the values of the predictors in the <code>newdata</code> data
set:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.nested, <span class="at">newdata=</span>new)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">head</span>(plotdata)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;   hincome children response       p    se.p   logit se.logit</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1       0   absent not.work 0.20820 0.06326 -1.3358   0.3838</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 2       0   absent parttime 0.02372 0.01775 -3.7176   0.7666</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 3       0   absent fulltime 0.76809 0.06386  1.1975   0.3585</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 4       5   absent not.work 0.24522 0.05799 -1.1243   0.3133</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 5       5   absent parttime 0.03785 0.02222 -3.2356   0.6101</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 6       5   absent fulltime 0.71694 0.05933  0.9293   0.2923</span></span></code></pre></div>
</div>
<div id="plotting-with-ggplot2" class="section level2">
<h2>Plotting with <code>ggplot2</code></h2>
<p>Then we can plot probability against one predictor, use
<code>color</code> to distinguish the levels of the response
(<code>partic</code>) and facet the plot by <code>children</code>. The
point-wise standard errors are drawn in a 68% confidence envelope using
<code>geom_ribbon()</code>. We’ve also plotted the predicted values as
points to show where the predictions are obtained.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotdata,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>hincome, <span class="at">y=</span>p, <span class="at">color=</span>response)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> children, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>p <span class="sc">-</span> se.p,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                  <span class="at">ymax=</span>p <span class="sc">+</span> se.p,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                  <span class="at">fill =</span> response), <span class="at">alpha =</span> <span class="fl">0.3</span>) </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>gg1</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-p1-1.png" class="r-plt" alt="**ggplot**: Predicted probabilities of working at all or working part time or full time versus husband's income, by `children`" width="100%" />
<p class="caption">
<strong>ggplot</strong>: Predicted probabilities of working at all or
working part time or full time versus husband’s income, by
<code>children</code>
</p>
</div>
<p>It is noteworthy that the confidence envelopes are wider for
not-working women at higher levels of husband’s income, where there are
fewer observations.</p>
<div id="direct-labels" class="section level3">
<h3>Direct labels</h3>
<p>Plot legends are somewhat hard to read and take up unnecessary space
in the plot, so it is often better to label the curves directly. The
<code>geomtextpath</code> package <span class="citation">(Cameron &amp;
van den Brand, 2025)</span> produces a nicer plot.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>gg1 <span class="sc">+</span> <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">label =</span> response), </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-p2-1.png" class="r-plt" alt="The same plot using direct labels on the curves rather than a legend." width="100%" />
<p class="caption">
The same plot using direct labels on the curves rather than a legend.
</p>
</div>
</div>
<div id="plotting-log-odds" class="section level3">
<h3>Plotting log-odds</h3>
<p>The advantage of the data structure returned by
<code>as.data.frame()</code> is that you can just as easily plot the
predicted probabilities on the scale of log-odds
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{logit}(p) = \log(p / (1-p))</annotation></semantics></math>),
using the <code>logit</code> and <code>logit.se</code> components.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>hincome, <span class="at">y=</span>logit, <span class="at">color=</span>response)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Log Odds&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> children, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>logit <span class="sc">-</span> se.logit,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                  <span class="at">ymax=</span>logit <span class="sc">+</span> se.logit,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>                  <span class="at">fill =</span> response), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">label =</span> response), </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-logit-1.png" class="r-plt" alt="Predicted log odds of working at all or working part time or full time versus husband's income, by `children`" width="100%" />
<p class="caption">
Predicted log odds of working at all or working part time or full time
versus husband’s income, by <code>children</code>
</p>
</div>
</div>
</div>
<div id="predicted-logit-values-for-the-dichotomies"
class="section level2">
<h2>Predicted logit values for the dichotomies</h2>
<p>The nested logit model <code>wlf.nested</code> comprises the two
binary logistic regression models for the <code>work</code> and
<code>full</code> dichotomies. We can plot these as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">models</span>(wlf.nested))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;work&quot; &quot;full&quot;</span></span></code></pre></div>
<p>The <code>predict()</code> method can also generate predicted values
and their standard errors for the logits of these dichotomies, using the
<code>model = "dichotomies"</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>pred.dichot <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested, <span class="at">newdata =</span> new,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;dichotomies&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">str</span>(pred.dichot)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;  $ work :&#39;data.frame&#39;:   20 obs. of  3 variables:</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;   ..$ fit           : num [1:20] 1.336 1.124 0.913 0.701 0.49 ...</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;   ..$ se.fit        : num [1:20] 0.384 0.313 0.262 0.242 0.261 ...</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt;   ..$ residual.scale: num [1:20] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;  $ full :&#39;data.frame&#39;:   20 obs. of  3 variables:</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt;   ..$ fit           : num [1:20] 3.48 2.94 2.41 1.87 1.33 ...</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt;   ..$ se.fit        : num [1:20] 0.767 0.613 0.489 0.423 0.443 ...</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;   ..$ residual.scale: num [1:20] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt;  $ .data:&#39;data.frame&#39;:   20 obs. of  2 variables:</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt;   ..$ hincome : num [1:20] 0 5 10 15 20 25 30 35 40 45 ...</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt;   ..$ children: Factor w/ 2 levels &quot;absent&quot;,&quot;present&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;out.attrs&quot;)=List of 2</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt;   .. ..$ dim     : Named int [1:2] 10 2</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;hincome&quot; &quot;children&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt;   .. ..$ dimnames:List of 2</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ hincome : chr [1:10] &quot;hincome= 0&quot; &quot;hincome= 5&quot; &quot;hincome=10&quot; &quot;hincome=15&quot; ...</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ children: chr [1:2] &quot;children=absent&quot; &quot;children=present&quot;</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;model&quot;)= chr &quot;wlf.nested&quot;</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;dichotomies&quot;)= chr [1:2] &quot;work&quot; &quot;full&quot;</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;predictDichotomies&quot;</span></span></code></pre></div>
<p>Transforming this to a data frame, we get an analogous result for
plotting:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>plotlogit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.dichot, <span class="at">newdata =</span> new)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">head</span>(plotlogit)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;   hincome children response  logit se.logit</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 1       0   absent     work 1.3358   0.3838</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 2       5   absent     work 1.1243   0.3133</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 3      10   absent     work 0.9127   0.2620</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 4      15   absent     work 0.7012   0.2422</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 5      20   absent     work 0.4897   0.2613</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 6      25   absent     work 0.2781   0.3121</span></span></code></pre></div>
<p>Then, plot the <code>logit</code> vs. husband’s income, with separate
curves for the two sub-models:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(plotlogit,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>hincome, <span class="at">y=</span>logit, <span class="at">color=</span>response)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Log Odds&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> children, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>logit <span class="sc">-</span> se.logit,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>                  <span class="at">ymax=</span>logit <span class="sc">+</span> se.logit,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                  <span class="at">fill =</span> response), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">label =</span> response),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-dichot1-1.png" class="r-plt" alt="Predicted logits for the two dichotomies, `work` and `full` versus `hincome`, by `children`" width="100%" />
<p class="caption">
Predicted logits for the two dichotomies, <code>work</code> and
<code>full</code> versus <code>hincome</code>, by <code>children</code>
</p>
</div>
<p>Or, interchanging the roles of <code>children</code> and
<code>response</code>, we can plot these the other way, faceting by
<code>response</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(plotlogit,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>hincome, <span class="at">y=</span>logit, <span class="at">color=</span>children)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Log Odds&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> response, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>logit <span class="sc">-</span> se.logit,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>                  <span class="at">ymax=</span>logit <span class="sc">+</span> se.logit,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>                  <span class="at">fill =</span> children), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">label =</span> children),</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-dichot2-1.png" class="r-plt" alt="Predicted logits for the two dichotomies, `work` and `full` versus `hincome`, by `response`" width="100%" />
<p class="caption">
Predicted logits for the two dichotomies, <code>work</code> and
<code>full</code> versus <code>hincome</code>, by <code>response</code>
</p>
</div>
<p>This nicely illustrates the nature of the fitted logit models: The
lines in each panel have the same slopes for the two levels of
<code>children</code>, differing only in their intercepts. The
<code>full</code> distinction between working full-time vs. part-time
decreases faster with husband’s income than for the <code>work</code>
dichotomy between not working at all and working either part-time or
full-time.</p>
</div>
<div id="alternative-model" class="section level2">
<h2>Alternative model</h2>
<p>In the main vignette we mentioned that an alternative set of nested
dichotomies first contrasts full-time work with the other categories,
{full-time} vs. {not working, part-time}, and then {not working}
vs. {part-time}.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>wlf.nested.alt <span class="ot">&lt;-</span> <span class="fu">nestedLogit</span>(partic <span class="sc">~</span> hincome <span class="sc">+</span> children,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                              <span class="fu">logits</span>(<span class="at">full=</span><span class="fu">dichotomy</span>(<span class="at">nonfulltime=</span><span class="fu">c</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>), <span class="st">&quot;fulltime&quot;</span>),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                                     <span class="at">part=</span><span class="fu">dichotomy</span>(<span class="st">&quot;not.work&quot;</span>, <span class="st">&quot;parttime&quot;</span>)),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                              <span class="at">data=</span>Womenlf)</span></code></pre></div>
<p>Proceeding in the same way as above, we get predicted logits and
standard errors for each of the dichotomies.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>pred.dichot.alt <span class="ot">&lt;-</span> <span class="fu">predict</span>(wlf.nested.alt, <span class="at">newdata =</span> new,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;dichotomies&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>plotlogit.alt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.dichot.alt, <span class="at">newdata =</span> new)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">head</span>(plotlogit.alt)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt;   hincome children response   logit se.logit</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; 1       0   absent     full  1.7696   0.4690</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; 2       5   absent     full  1.2762   0.3577</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; 3      10   absent     full  0.7827   0.2723</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; 4      15   absent     full  0.2893   0.2421</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; 5      20   absent     full -0.2042   0.2852</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 6      25   absent     full -0.6976   0.3772</span></span></code></pre></div>
<p>Plotting these as before:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>(plotlogit.alt,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>hincome, <span class="at">y=</span>logit, <span class="at">color=</span>children)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Husband&#39;s Income&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Log Odds&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> response, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>logit <span class="sc">-</span> se.logit,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                  <span class="at">ymax=</span>logit <span class="sc">+</span> se.logit,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                  <span class="at">fill =</span> children), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">label =</span> children),</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="fig/wlf-ggplot-alt1-1.png" class="r-plt" alt="Predicted logits for the two dichotomies, `work` and `full` versus `hincome`, by `response`" width="100%" />
<p class="caption">
Predicted logits for the two dichotomies, <code>work</code> and
<code>full</code> versus <code>hincome</code>, by <code>response</code>
</p>
</div>
<p>It’s apparent that the alternative model produces a simpler
description of the data: The predictors husband’s income and presence of
children affect the decision to work full-time, but not the decision to
work part-time among those who aren’t engaged in full-time work. In
particular it is clear that neither husband’s income nor having young
children has any effect on the decision to work part-time.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0" line-spacing="2">
<div id="ref-R-geomtextpath" class="csl-entry">
Cameron, A., &amp; van den Brand, T. (2025). <em>Geomtextpath: Curved
text in ggplot2</em>. Retrieved from <a
href="https://allancameron.github.io/geomtextpath/">https://allancameron.github.io/geomtextpath/</a>
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, H., Chang, W., Henry, L., Pedersen, T. L., Takahashi, K.,
Wilke, C., … van den Brand, T. (2025). <em>ggplot2: Create elegant data
visualisations using the grammar of graphics</em>. Retrieved from <a
href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>
